(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[41],{6975:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/getting-started/integration-tests",function(){return t(2368)}])},1893:function(e,s,t){"use strict";t.d(s,{Z:function(){return x}});var n=t(5893);t(7294);var r=t(5675),o=t.n(r),l={src:"/_next/static/media/atlas-logo-light-mode.6077cdd3.svg",height:320,width:937,blurWidth:0,blurHeight:0},i={src:"/_next/static/media/atlas-logo-dark-mode.62b4f6dd.svg",height:320,width:945,blurWidth:0,blurHeight:0},a=t(2010);let c=()=>{let{resolvedTheme:e}=(0,a.F)();return(0,n.jsx)(o(),{src:"light"===e?l:i,alt:"Atlas Logo",height:"42"})};var h=t(1163);let d={logo:(0,n.jsx)(c,{}),project:{link:"https://github.com/geniusyield/atlas"},docsRepositoryBase:"https://github.com/geniusyield/atlas-docs/tree/main",useNextSeoProps(){let{asPath:e}=(0,h.useRouter)(),s="All-in-one solution for writing off-chain code for Plutus contracts";return{titleTemplate:"/"===e?"ATLAS Plutus Application Backend | by Genius Yield":"Atlas | %s",description:s,canonical:"https://atlas-app.io",openGraph:{url:"https://atlas-app.io",description:s,images:[{url:"/open-graph.png",width:1200,height:630,alt:"Atlas - Application backend for Plutus smart contracts on Cardano",type:"image/png"}]},siteName:"Atlas",twitter:{handle:"@GeniusyieldO",site:"https://www.geniusyield.co",cardType:"summary_large_image"}}},head:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("link",{rel:"apple-touch-icon",sizes:"180x180",href:"/favicon/apple-touch-icon.png"}),(0,n.jsx)("link",{rel:"icon",type:"image/png",sizes:"32x32",href:"/favicon/favicon-32x32.png"}),(0,n.jsx)("link",{rel:"icon",type:"image/png",sizes:"16x16",href:"/favicon/favicon-16x16.png"}),(0,n.jsx)("link",{rel:"manifest",href:"/favicon/site.webmanifest"}),(0,n.jsx)("link",{rel:"mask-icon",href:"/favicon/safari-pinned-tab.svg",color:"#5bbad5"}),(0,n.jsx)("link",{rel:"shortcut icon",href:"/favicon/favicon.ico"}),(0,n.jsx)("meta",{name:"msapplication-TileColor",content:"#da532c"}),(0,n.jsx)("meta",{name:"msapplication-config",content:"/favicon/browserconfig.xml"}),(0,n.jsx)("meta",{name:"theme-color",content:"#ffffff"})]}),footer:{component:(0,n.jsx)(n.Fragment,{})},nextThemes:{defaultTheme:"dark"},darkMode:!1,sidebar:{toggleButton:!0}};var x=d},2368:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return a.Z}});var n=t(5893),r=t(8808),o=t(4783),l=t(1893);t(9966);var i=t(1151);t(5675);var a=t(2243);function c(e){let s=Object.assign({h1:"h1",p:"p",em:"em",table:"table",thead:"thead",tr:"tr",th:"th",strong:"strong",tbody:"tbody",td:"td",code:"code",h2:"h2",a:"a",ol:"ol",li:"li",sup:"sup",ul:"ul",pre:"pre",span:"span",section:"section"},(0,i.ah)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{children:"Integration Tests"}),"\n",(0,n.jsxs)(s.p,{children:["We already saw how we can conveniently write tests for our smart contract using our wrapper upon Plutus simple model. But these tests were running against a mock ledger, i.e., we really were just simulating it by having some mock data-structures (say set of UTxOs) which were getting updated on submission of successful transaction. We could however write tests to test against the real node and have it slightly more convenient to program against by spinning up our own private network (",(0,n.jsx)(s.em,{children:"privnet"})," for short). Here is the table which outlines the differences between the two approaches:"]}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"Tests using PSM Wrapper"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"Tests using Private Network"})})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Runs against mock ledger"}),(0,n.jsx)(s.td,{children:"Runs against real node"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Each unit test gets fresh set of wallets (having original balance)"}),(0,n.jsx)(s.td,{children:"Each subsequent unit test continues upon the effects caused by previous ones"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:["Fast, purer (no ",(0,n.jsx)(s.code,{children:"IO"}),") & convenient"]}),(0,n.jsx)(s.td,{children:"Slow as each slot is 0.1 second"})]})]})]}),"\n",(0,n.jsx)(s.p,{children:"Thus these tests are suitable for integration testing."}),"\n",(0,n.jsx)(s.h2,{id:"spinning-up-private-network",children:"Spinning up private network"}),"\n",(0,n.jsxs)(s.p,{children:["Our private network is adapted from WoofPool's ",(0,n.jsx)(s.a,{href:"https://github.com/woofpool/cardano-private-testnet-setup",children:(0,n.jsx)(s.code,{children:"cardano-private-testnet-setup"})})," repository."]}),"\n",(0,n.jsx)(s.p,{children:"To spin up it up:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["Clone ",(0,n.jsx)(s.a,{href:"https://github.com/geniusyield/cardano-private-testnet-setup",children:"this"})," repository. Make sure to not clone it in some deep nested path as then the path length towards the generated socket file (",(0,n.jsx)(s.code,{children:"node.sock"}),") may exceed 108 characters",(0,n.jsx)(s.sup,{children:(0,n.jsx)(s.a,{href:"#user-content-fn-5",id:"user-content-fnref-5","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})}),"."]}),"\n",(0,n.jsxs)(s.li,{children:["Enter it & checkout ",(0,n.jsx)(s.code,{children:"geniusyield"})," branch."]}),"\n",(0,n.jsxs)(s.li,{children:["Enter the following in terminal: ",(0,n.jsx)(s.code,{children:"./scripts/automate.sh"})," (you would need to have ",(0,n.jsx)(s.code,{children:"cardano-node"})," & ",(0,n.jsx)(s.code,{children:"cardano-cli"})," available in your ",(0,n.jsx)(s.code,{children:"PATH"}),")."]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:['Once it says, "',(0,n.jsx)(s.em,{children:"Congrats! Your network is ready for use!"}),'" you can attempt to run the tests (in another terminal).']}),"\n",(0,n.jsxs)(s.p,{children:["First, let's say the path to ",(0,n.jsx)(s.code,{children:"private-testnet-simple"})," is ",(0,n.jsx)(s.code,{children:"X"}),", then being inside your example project folder, you can execute the tests by running ",(0,n.jsx)(s.code,{children:"GENIUSYIELD_PRIVNET_DIR=$X/private-testnet cabal run betref-privnet-tests -- -j1"})]}),"\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.code,{children:"-j1"})," is needed so that the tests run sequentially."]}),"\n",(0,n.jsx)(o.UW,{type:"info",children:(0,n.jsxs)(s.p,{children:["Remember to stop (",(0,n.jsx)(s.code,{children:"CTRL-C"}),", and ",(0,n.jsx)(s.code,{children:"killall cardano-node"}),") the private testnet, or it will eventually eat all of your disk space."]})}),"\n",(0,n.jsx)(s.p,{children:"The way we have it setup for our test boilerplate is that we have nine users where users second to nine start with the following balances:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"5 UTxOs each containing thousand ada"}),"\n",(0,n.jsx)(s.li,{children:"1 million each of gold & iron tokens"}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:['First user is called "',(0,n.jsx)(s.em,{children:"funder"}),'" as it has far more ada (couple of 100 thousands) and the number of gold & iron tokens is 2 millions.']}),"\n",(0,n.jsx)(s.p,{children:"We'll also see how to create a new user soon, if required."}),"\n",(0,n.jsx)(o.UW,{type:"warning",children:(0,n.jsxs)(s.p,{children:["Unless you kill & restart the private network, running your privnet tests again, would have them run in the modified network state. So in general, if you wish to reexecute the command mentioned before, viz. ",(0,n.jsx)(s.code,{children:"ATLAS_PRIVNET_DIR=$(pwd)/private-testnet-simple/private-testnet cabal run privnet-tests -- -j1"}),", you should first restart the privnet",(0,n.jsx)(s.sup,{children:(0,n.jsx)(s.a,{href:"#user-content-fn-1",id:"user-content-fnref-1","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"2"})}),"."]})}),"\n",(0,n.jsx)(s.h2,{id:"understanding-our-first-test",children:"Understanding our first test"}),"\n",(0,n.jsx)(o.UW,{type:"warning",emoji:"\uD83D\uDCC3",children:(0,n.jsxs)(s.p,{children:["The tests are written in ",(0,n.jsx)(s.a,{href:"https://github.com/geniusyield/atlas-examples/tree/main/bet-ref/tests-privnet/BetRef/Tests/Privnet/Tests.hs",children:"this"})," file and are being called ",(0,n.jsx)(s.a,{href:"https://github.com/geniusyield/atlas-examples/tree/main/bet-ref/tests-privnet/betref-privnet-tests.hs",children:"here"}),"."]})}),"\n",(0,n.jsx)(s.p,{children:"Here is the code (& explaination follows after it):"}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  testCaseSteps "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Balance checks & taking pot by closest guesser should pass"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"\\"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"info "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" withSetup setup info "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"\\"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"ctx "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"do"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- First step: Construct the parameters and obtain validator from it."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"--"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Let's define a new User to represent Oracle (not necessary though)"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    oracleUser "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" newTempUserCtx ctx (ctxUserF ctx) (valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"20_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") False"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    (currentSlot"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" slotConfig) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" getSlotAndConfig ctx"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" betUntilSlotDelta "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"100"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        betRevealSlotDelta "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"200"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        betUntilTime "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" slotToBeginTimePure slotConfig (unsafeAdvanceSlot currentSlot betUntilSlotDelta)"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        betRevealTime "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" slotToBeginTimePure slotConfig (unsafeAdvanceSlot currentSlot betRevealSlotDelta)"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        brp "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" BetRefParams (pubKeyHashToPlutus "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" userPkh oracleUser) (timeToPlutus betUntilTime) (timeToPlutus betRevealTime) (valueToPlutus "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"10_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        validator "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" betRefValidator' brp"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    validatorAddress "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ctxRunC ctx (ctxUserF ctx) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" betRefAddress brp"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Second step: Putting reference script for validator."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    refScript "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" addRefScriptCtx ctx (ctxUserF ctx) (validatorToScript validator)"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Third step: Put some bets."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"--"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- 1st bet."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    txBodyLock "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ctxRunI ctx (ctxUser3 ctx) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" placeBet refScript brp (OracleAnswerDatum "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") (valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"10_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") (userAddr (ctxUser3 ctx)) Nothing"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    lockedORef "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" findOutput validatorAddress txBodyLock"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    void "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" submitTx ctx (ctxUser3 ctx) txBodyLock"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Balance of `(ctxUser2 ctx)` before placing the bet"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    balance "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ctxQueryBalance ctx (ctxUser2 ctx)"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"--"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- 2nd bet."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    txBodyLockUser2 "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ctxRunI ctx (ctxUser2 ctx) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" placeBet refScript brp (OracleAnswerDatum "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") (valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"20_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") (userAddr (ctxUser2 ctx)) (Just lockedORef)"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    lockedORef "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" findOutput validatorAddress txBodyLockUser2"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    void "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" submitTx ctx (ctxUser2 ctx) txBodyLockUser2"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"--"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- 3rd bet."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    txBodyLock "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ctxRunI ctx (ctxUser3 ctx) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" placeBet refScript brp (OracleAnswerDatum "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"3"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") (valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"35_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") (userAddr (ctxUser3 ctx)) (Just lockedORef)"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    lockedORef "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" findOutput validatorAddress txBodyLock"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    void "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" submitTx ctx (ctxUser3 ctx) txBodyLock"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Fourth step, get the bets pot."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"--"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Let's first wait for the required amount"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    ctxWaitUntilSlot ctx (unsafeAdvanceSlot currentSlot betRevealSlotDelta)  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- here this `currentSlot` is what we obtained sometime ago, the actual current slot has certainly increased a lot by now."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"--"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Let's then add for the reference input"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    refInputORef "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" addRefInputCtx ctx (ctxUserF ctx) True (userAddr oracleUser) (datumFromPlutusData (OracleAnswerDatum "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"))"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"--"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Unlock operation"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    txBodyUnlock "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ctxRunI ctx (ctxUser2 ctx) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" takeBets refScript brp lockedORef (userAddr (ctxUser2 ctx)) refInputORef"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    void "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" submitTx ctx (ctxUser2 ctx) txBodyUnlock"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"--"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Balance of `(ctxUser2 ctx)` after unlocking"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" adaExpectedIncrease "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"45_000_000"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    assertUserFunds (txBodyFee txBodyUnlock "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" txBodyFee txBodyLockUser2) ctx (ctxUser2 ctx) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" balance "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" adaExpectedIncrease"})]})]})}),"\n",(0,n.jsxs)(s.p,{children:["The first line ",(0,n.jsx)(s.code,{children:'testCaseSteps "test description" $ \\info -> withSetup setup info $ \\ctx -> do'})," can be seen as a boilerplate for all of your tests."]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"ctx"})," denotes the so called context (of type ",(0,n.jsx)(s.code,{children:"Ctx"}),") and contains information about our users, additional tokens, etc. It is defined in ",(0,n.jsx)(s.a,{href:"https://github.com/geniusyield/atlas/tree/main/src/GeniusYield/Test/Privnet/Ctx.hs",children:(0,n.jsx)(s.code,{children:"Ctx.hs"})})," file and it is essential to go over that file if you intend to write these tests."]}),"\n",(0,n.jsxs)(s.p,{children:["Variable ",(0,n.jsx)(s.code,{children:"info"})," is used to log messages and you can use it in your test's ",(0,n.jsx)(s.code,{children:"do"})," block like ",(0,n.jsx)(s.code,{children:'info $ printf "Hello from %s" "Atlas"'})]}),"\n",(0,n.jsxs)(s.p,{children:["We next see the use of ",(0,n.jsx)(s.code,{children:"newTempUserCtx"})," utility function. As mentioned before, we already have nine users in our context, where they have the type ",(0,n.jsx)(s.code,{children:"User"}),":"]}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"data"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"User"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" User"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    { userSKey "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"!GYPaymentSigningKey"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    , userAddr "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"!GYAddress"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})})]})}),"\n",(0,n.jsxs)(s.p,{children:["But at rare times, we might need to create a new user. Such a user would not be part of the context and thus would be local to the test creating it",(0,n.jsx)(s.sup,{children:(0,n.jsx)(s.a,{href:"#user-content-fn-2",id:"user-content-fnref-2","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"3"})}),"."]}),"\n",(0,n.jsxs)(s.p,{children:["We can do that with the help of ",(0,n.jsx)(s.code,{children:"newTempUserCtx"})," function. It accepts the context parameter, the user which will fund this new user, the value to be given to this new user and a boolean denoting whether we want to create a 5-ada-only UTxO too for this new user."]}),"\n",(0,n.jsxs)(s.p,{children:["Next we see the use of ",(0,n.jsx)(s.code,{children:"getSlotAndConfig"})," function. Earlier when we wrote for PSM tests, we could work in absolute slots as we were always running each test from the beginning of ledger but this is not the case here. Thus, we would need to work with relative slots, i.e., we find the current slot and then add offset with respect to it. Function ",(0,n.jsx)(s.code,{children:"getSlotAndConfig"})," has the folowing definition:"]}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"getSlotAndConfig"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Ctx"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"IO"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYSlot"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYSlotConfig"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"getSlotAndConfig ctx "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"do"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  slot "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ctxCurrentSlot ctx"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  sc   "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ctxSlotConfig ctx"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  return (slot"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" sc)"})]})]})}),"\n",(0,n.jsxs)(s.p,{children:["Next we compute for our contract parameters and since we already obtained the slot config, we can use ",(0,n.jsx)(s.code,{children:"slotToBeginTimePure"})," instead of ",(0,n.jsx)(s.code,{children:"slotToBeginTime"}),"."]}),"\n",(0,n.jsxs)(s.p,{children:["We next see the use of ",(0,n.jsx)(s.code,{children:"ctxRunC"}),". To understand it, we need to first look at signature of ",(0,n.jsx)(s.code,{children:"ctxRunF"}),"."]}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsx)(s.code,{"data-language":"haskell","data-theme":"default",children:(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"ctxRunF"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"forall"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" t v"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Traversable"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" t "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Ctx"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"User"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxMonadNode"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (t ("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxSkeleton"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" v)) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"IO"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (t "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxBody"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})})}),"\n",(0,n.jsxs)(s.p,{children:["We see that it has a type variable ",(0,n.jsx)(s.code,{children:"t"})," which should have an instance of ",(0,n.jsx)(s.code,{children:"Traversable"}),". The other two functions, namely ",(0,n.jsx)(s.code,{children:"ctxRunC"})," & ",(0,n.jsx)(s.code,{children:"ctxRunI"})," call this ",(0,n.jsx)(s.code,{children:"ctxRunF"})," function with suitable instantiation of type variable ",(0,n.jsx)(s.code,{children:"t"}),"."]}),"\n",(0,n.jsxs)(s.p,{children:["Here is the table which explains about these three (",(0,n.jsx)(s.code,{children:"ctxRunF"}),", ",(0,n.jsx)(s.code,{children:"ctxRunC"})," & ",(0,n.jsx)(s.code,{children:"ctxRunI"}),") related functions:"]}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Function"}),(0,n.jsx)(s.th,{children:"When to use?"}),(0,n.jsx)(s.th,{children:"What does it do?"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"ctxRunI"})}),(0,n.jsxs)(s.td,{children:["When you want to build for single ",(0,n.jsx)(s.code,{children:"GYTxSkeleton"})]}),(0,n.jsxs)(s.td,{children:["It wraps our skeleton under ",(0,n.jsx)(s.code,{children:"Identity"}),(0,n.jsx)(s.sup,{children:(0,n.jsx)(s.a,{href:"#user-content-fn-3",id:"user-content-fnref-3","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"4"})}),", that is what suffix ",(0,n.jsx)(s.code,{children:"I"})," stands for"]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"ctxRunF"})}),(0,n.jsxs)(s.td,{children:["When you have say multiple skeletons, like ",(0,n.jsx)(s.code,{children:"[GYTxSkeleton]"}),", or ",(0,n.jsx)(s.code,{children:"Maybe GYTxSkeleton"})]}),(0,n.jsx)(s.td,{children:"-"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"ctxRunC"})}),(0,n.jsxs)(s.td,{children:["When you don't want to build skeletons. This is in particular useful for operations like ",(0,n.jsx)(s.code,{children:"utxosAtAddress"})]}),(0,n.jsxs)(s.td,{children:["The type constructor ",(0,n.jsx)(s.code,{children:"Const"})," is defined as ",(0,n.jsx)(s.code,{children:"newtype Const a b = Const { getConst :: a }"})," and therefore type parameter ",(0,n.jsx)(s.code,{children:"b"})," is phantom and thus this function helps us ignore for ",(0,n.jsx)(s.code,{children:"GYTxSkeleton"})]})]})]})]}),"\n",(0,n.jsxs)(s.p,{children:["We next add for reference script using helper utility function ",(0,n.jsx)(s.code,{children:"addRefScriptCtx"}),"."]}),"\n",(0,n.jsxs)(s.p,{children:["We then start placing our bets, once we have the transaction body, we use ",(0,n.jsx)(s.code,{children:"findOutput"})," function which gives us the reference to the UTxO (the first one it finds",(0,n.jsx)(s.sup,{children:(0,n.jsx)(s.a,{href:"#user-content-fn-4",id:"user-content-fnref-4","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"5"})}),") that is being locked at the script address."]}),"\n",(0,n.jsxs)(s.p,{children:["After placing our bets, we use ",(0,n.jsx)(s.code,{children:"ctxWaitUntilSlot"})," to wait till the unlock slot."]}),"\n",(0,n.jsx)(s.p,{children:"Note that we queried the balance of unlocker so that we can compare with it later."}),"\n",(0,n.jsxs)(s.p,{children:["We next add for our reference input using ",(0,n.jsx)(s.code,{children:"addRefInputCtx"})," helper utility function."]}),"\n",(0,n.jsxs)(s.p,{children:["Next we perform the unlock operation (calling our ",(0,n.jsx)(s.code,{children:"takeBets"})," operation)."]}),"\n",(0,n.jsxs)(s.p,{children:["Lastly, we verify that the unlocker was able to take all the bets by comparing the balance using ",(0,n.jsx)(s.code,{children:"assertUserFunds"})," method. Here is it's definition:"]}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- | Asserts if the user funds change as expected. This function subtracts fees from the given expected value."})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"assertUserFunds"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Integer"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Ctx"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"User"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYValue"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"IO"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"()"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"assertUserFunds fees ctx u expectedValue "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"do"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    currentValue "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ctxQueryBalance ctx u"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" expectedValue' "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" expectedValue "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"`valueMinus`"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueFromLovelace fees"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    assertBool (unwords ["}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"The value didn\'t change as expected"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                         "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"\\nExpected: "'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" show expectedValue'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                         "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"\\nCurrent: "'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" show currentValue])"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"               (currentValue "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" expectedValue')"})]})]})}),"\n",(0,n.jsx)(s.h2,{id:"writing-a-failing-test",children:"Writing a failing test"}),"\n",(0,n.jsx)(s.p,{children:"Now let's see another test where we slightly modify the last step (all the rest is same) and this time we instead try to take funds by not the closest guesser."}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Fourth step, get the bets pot."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"--"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Let's first wait for the required amount"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  ctxWaitUntilSlot ctx (unsafeAdvanceSlot currentSlot betRevealSlotDelta)  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- here this `currentSlot` is what we obtained sometime ago, the actual current slot has certainly increased a lot by now."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"--"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Let's then add for the reference input"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  refInputORef "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" addRefInputCtx ctx (ctxUserF ctx) True (userAddr oracleUser) (datumFromPlutusData (OracleAnswerDatum "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"))"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"--"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Unlock operation"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- But this time by wrong guesser"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  assertThrown isTxBodyErrorAutoBalance "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ctxRunI ctx (ctxUser3 ctx) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" takeBets refScript brp lockedORef (userAddr (ctxUser3 ctx)) refInputORef"})]})]})}),"\n",(0,n.jsxs)(s.p,{children:["Notice that we try catching the error using ",(0,n.jsx)(s.code,{children:"assertThrown"})," function. Here ",(0,n.jsx)(s.code,{children:"isTxBodyErrorAutoBalance"})," is defined as (both this & ",(0,n.jsx)(s.code,{children:"assertThrown"})," have their definitions in ",(0,n.jsx)(s.a,{href:"https://github.com/geniusyield/atlas/tree/main/src/GeniusYield/Test/Privnet/Asserts.hs",children:(0,n.jsx)(s.code,{children:"Asserts.hs"})})," file):"]}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"isTxBodyErrorAutoBalance"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"BuildTxException"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Bool"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"isTxBodyErrorAutoBalance (BuildTxBodyErrorAutoBalance _) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" True"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"isTxBodyErrorAutoBalance _                               "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" False"})]})]})}),"\n",(0,n.jsxs)(s.p,{children:["Thus our ",(0,n.jsx)(s.code,{children:"assertThrown"})," function checks for two things:"]}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"Whether our action indeed raises an exception."}),"\n",(0,n.jsxs)(s.li,{children:["If an exception is raised, does it saitsfy our predicate? For instance, here our predicate was ",(0,n.jsx)(s.code,{children:"isTxBodyErrorAutoBalance"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(o.UW,{children:[(0,n.jsxs)(s.p,{children:["You can also catch for ",(0,n.jsx)(s.code,{children:"IO"})," error like:"]}),(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  errored "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" catchIOError (submitTx ctx (ctxUserF ctx) txBody "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pure False) ("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"\\"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"_ "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pure True)"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  unless errored "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" assertFailure "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Expecting an IOError exception"'})]})]})})]}),"\n",(0,n.jsx)(s.p,{children:"With this we conclude upon writing integration tests."}),"\n",(0,n.jsxs)(s.section,{"data-footnotes":!0,className:"footnotes",children:[(0,n.jsx)(s.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{id:"user-content-fn-5",children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.a,{href:"https://unix.stackexchange.com/q/367008",children:"https://unix.stackexchange.com/q/367008"})," ",(0,n.jsx)(s.a,{href:"#user-content-fnref-5","data-footnote-backref":!0,className:"data-footnote-backref","aria-label":"Back to content",children:""})]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{id:"user-content-fn-1",children:["\n",(0,n.jsxs)(s.p,{children:["For convenience, you can write a bash script which combines setup, running tests & closing the privnet all into one simple script. ",(0,n.jsx)(s.a,{href:"#user-content-fnref-1","data-footnote-backref":!0,className:"data-footnote-backref","aria-label":"Back to content",children:""})]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{id:"user-content-fn-2",children:["\n",(0,n.jsxs)(s.p,{children:["Even though this user is local to the test which created it, it would still persist in our private network. ",(0,n.jsx)(s.a,{href:"#user-content-fnref-2","data-footnote-backref":!0,className:"data-footnote-backref","aria-label":"Back to content",children:""})]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{id:"user-content-fn-3",children:["\n",(0,n.jsxs)(s.p,{children:["Technically, it's not wrapper that is happening place here but rather we coerce with ",(0,n.jsx)(s.code,{children:"Identity"})," newtype. ",(0,n.jsx)(s.a,{href:"#user-content-fnref-3","data-footnote-backref":!0,className:"data-footnote-backref","aria-label":"Back to content",children:""})]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{id:"user-content-fn-4",children:["\n",(0,n.jsxs)(s.p,{children:["Therefore this function is intended to be used when we create only a single output for an external address. ",(0,n.jsx)(s.a,{href:"#user-content-fnref-4","data-footnote-backref":!0,className:"data-footnote-backref","aria-label":"Back to content",children:""})]}),"\n"]}),"\n"]}),"\n"]})]})}e=t.hmd(e),(0,r.j)({Content:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,i.ah)(),e.components);return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(c,{...e})}):c(e)},nextraLayout:o.ZP,hot:e.hot,pageOpts:{filePath:"src/pages/getting-started/integration-tests.mdx",route:"/getting-started/integration-tests",frontMatter:{},pageMap:[{kind:"Meta",data:{index:{title:"Atlas",display:"hidden",theme:{layout:"raw"}},documentation:{title:"Documentation",type:"page",href:"/introduction"},introduction:"Introduction","getting-started":"Getting Started","more-tutorials":"More Tutorials"}},{kind:"Folder",name:"getting-started",route:"/getting-started",children:[{kind:"Meta",data:{"smart-contract-intro":"Smart Contract",operations:"Operations over Contract","unit-tests":"Unit Tests","integration-tests":"Integration Tests",endpoints:"Creating Endpoints","browser-integration":"Browser Integration"}},{kind:"MdxPage",name:"browser-integration",route:"/getting-started/browser-integration"},{kind:"MdxPage",name:"endpoints",route:"/getting-started/endpoints"},{kind:"MdxPage",name:"integration-tests",route:"/getting-started/integration-tests"},{kind:"MdxPage",name:"operations",route:"/getting-started/operations"},{kind:"MdxPage",name:"smart-contract-intro",route:"/getting-started/smart-contract-intro"},{kind:"MdxPage",name:"unit-tests",route:"/getting-started/unit-tests"}]},{kind:"MdxPage",name:"getting-started",route:"/getting-started"},{kind:"MdxPage",name:"index",route:"/"},{kind:"MdxPage",name:"introduction",route:"/introduction"},{kind:"MdxPage",name:"more-tutorials",route:"/more-tutorials"}],headings:[{depth:1,value:"Integration Tests",id:"integration-tests"},{depth:2,value:"Spinning up private network",id:"spinning-up-private-network"},{depth:2,value:"Understanding our first test",id:"understanding-our-first-test"},{depth:2,value:"Writing a failing test",id:"writing-a-failing-test"}],flexsearch:{codeblocks:!0},title:"Integration Tests"},themeConfig:l.Z,pageNextRoute:"/getting-started/integration-tests",pageOptsChecksum:void 0,dynamicMetaModules:[]})}},function(e){e.O(0,[783,774,888,179],function(){return e(e.s=6975)}),_N_E=e.O()}]);