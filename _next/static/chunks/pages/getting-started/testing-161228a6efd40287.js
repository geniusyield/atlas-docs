(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[904],{9459:function(e,s,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/getting-started/testing",function(){return l(3287)}])},3287:function(e,s,l){"use strict";l.r(s),l.d(s,{__toc:function(){return c}});var n=l(5893),r=l(2673),o=l(3679),t=l(9296);l(4759);var i=l(2643),a=l(208);let c=[{depth:2,value:"Levels of testing",id:"levels-of-testing"},{depth:2,value:"Overview of unified testing in Atlas",id:"overview-of-unified-testing-in-atlas"},{depth:2,value:"Testing placing a bet",id:"testing-placing-a-bet"},{depth:3,value:"Testing environment",id:"testing-environment"},{depth:3,value:"Defining runner for bet placing operation",id:"defining-runner-for-bet-placing-operation"},{depth:3,value:"Additional runners",id:"additional-runners"},{depth:3,value:"Place first bet test",id:"place-first-bet-test"},{depth:3,value:"Multiple bets test",id:"multiple-bets-test"},{depth:3,value:"Writing negative tests",id:"writing-negative-tests"}];function h(e){let s=Object.assign({h1:"h1",p:"p",code:"code",h2:"h2",strong:"strong",ul:"ul",li:"li",a:"a",em:"em",ol:"ol",h3:"h3",pre:"pre",span:"span",sup:"sup",section:"section"},(0,i.a)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{children:"Testing"}),"\n",(0,n.jsx)(s.p,{children:"Writing smart contracts and operations over them go hand in hand with testing them."}),"\n",(0,n.jsxs)(s.p,{children:["Tests are also an excellent way to check your smart contracts\ninstead of building transactions using ",(0,n.jsx)(s.code,{children:"cardano-cli"}),"\nand submitting them to a local node."]}),"\n",(0,n.jsx)(s.h2,{id:"levels-of-testing",children:"Levels of testing"}),"\n",(0,n.jsxs)(s.p,{children:["Now that we have written our smart contracts and defined the required operations,\nlet's see whether they work as expected. When it comes to testing dApps there are\nplenty of techniques and approaches. Let's focus on ",(0,n.jsx)(s.strong,{children:"levels"})," at which we can\nperform testing:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Testing of UPLC functions."})," You may want to verify that individual functions\nyour validators consist of, indeed hold some properties. This is\nuseful if your on-chain logic is convoluted and involves complex computations.\nThis level is tightly coupled to the language you use to build your smart contracts\nso you should consult the respective documentation."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Testing of individual contracts (script level)."}),"\nYou might want to verify that the on-chain contracts you developed behave as expected\nin isolation just by calling them with hand-constructed arguments (like script context) since they are just functions after all\nand checking the results. Here again, you can use language-specific tools.\nBut in case your contracts are already compiled down to UPLC code,\nyou will need a special testing framework to do that.\nAtlas currently doesn't provide such a thing, but there exist some projects of help,\nnamely ",(0,n.jsx)(s.a,{href:"https://github.com/Liqwid-Labs/liqwid-libs/tree/main/plutarch-context-builder",children:"liqwid-context-builder"}),"\nfrom Liqwid's Libs mono repo. It allows one to easily construct various transaction contexts\nand verify a result that a particular script evaluates."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Testing of operations (transactions)."}),'\nAt this level, one can execute whole operations (transactions)\nan application provides and verifies that they a) can run through and\nb) confirm that some conditions we are interested in are held.\nA nice thing to know about Atlas is that it allows you to reuse the code for operations\nyou created in the previous step, "',(0,n.jsx)(s.a,{href:"./operations",children:"Operations over Contract"}),'".\nThis is the level of testing we discuss in this section.\nYou can also make a distinction between testing individual transactions and\ntesting a flow of transactions, but in practice, it proves to be hard\nto prepare a hand-made environment for most intermediary transactions to be run in\nwithout running transactions that precede, so mostly it boils down\nto test the whole transaction flow.']}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"overview-of-unified-testing-in-atlas",children:"Overview of unified testing in Atlas"}),"\n",(0,n.jsxs)(s.p,{children:["Testing of whole operations (transactions) requires a Cardano ledger to evaluate them\nand keep the state.\nThere are two interchangeable options available in Atlas.\nWe will call them ",(0,n.jsx)(s.em,{children:"ledger backends"})," throughout the rest of the section:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsxs)(s.strong,{children:[(0,n.jsx)(s.a,{href:"https://github.com/mlabs-haskell/clb",children:"CLB"})," emulator"]}),"\n(a modern replacement for deprecated ",(0,n.jsx)(s.a,{href:"https://github.com/mlabs-haskell/plutus-simple-model",children:"PSM"})," library)\nis the preferable way to test operations.\nIt's built around the pure Cardano ledger without the use of any network or consensus bits\nand offers incredibly high speed with a tiny memory footprint,\nbut with some functional limitations.\nYou can easily spin up a fresh emulator ledger for every test case,\nwhich makes running tests in isolation a trivial task."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Cardano private test network option"})," (privnet for short) provides a more realistic environment.\nIt is a cluster of three ",(0,n.jsx)(s.code,{children:"cardano-node"})," instances\nthat potentially could support all Cardano features,\nincluding staking and governance.\nThe main downside of a privnet is that testing time is significantly bigger and since spawning a testnet is a time-consuming operation, it's practically impossible to have a fresh network for every test case\nbut rather we prefer single testnet for the whole test suite run."]}),"\n"]}),"\n",(0,n.jsxs)(a.UW,{type:"info",emoji:"⚠️",children:[(0,n.jsx)(s.p,{children:"Bear in mind that the behavior of the CLB emulator and a Cardano private network differ."}),(0,n.jsx)(s.p,{children:"Not all features are supported in the emulator, and some notions, e.g. blocks and time\nis not represented enough in the emulator to carry out all tests."}),(0,n.jsx)(s.p,{children:"Fortunately, you can switch easily between two backends with unified testing."})]}),"\n",(0,n.jsxs)(s.p,{children:["Now that we know what the two backends available are,\nlet's spend some time understanding what ",(0,n.jsx)(s.strong,{children:"unified testing"})," in Atlas offers.\nIf we dissect a test case within a test suite\nwe can identify the following things involved:"]}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["An application under testing, including:","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Smart contracts"}),"\n",(0,n.jsx)(s.li,{children:"Operations, which usually prepare transactions (or their skeletons)"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["Definition of a test case, including:","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"A prelude sequence of actions that prepare the state for a particular\noperation to be ready to be executed"}),"\n",(0,n.jsx)(s.li,{children:"A condition that wraps an operation we are testing  in the test case\nand expresses checks we want to verify"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["Test suite runtime:","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"A ledger backend"}),"\n",(0,n.jsx)(s.li,{children:"Some code to run a test case against a backend"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"The idea of unified testing pursues the goal of making items under (1) and (2) reusable\nacross different (currently, the two mentioned above) ledger backends."}),"\n",(0,n.jsx)(s.p,{children:"Let's run through an example test suite to get the idea and figure out its details."}),"\n",(0,n.jsx)(s.h2,{id:"testing-placing-a-bet",children:"Testing placing a bet"}),"\n",(0,n.jsx)(a.UW,{type:"warning",emoji:"\uD83D\uDCC3",children:(0,n.jsxs)(s.p,{children:["You can find the entire code for this example ",(0,n.jsx)(s.a,{href:"https://github.com/geniusyield/atlas-examples/tree/main/bet-ref/tests",children:"here"}),".\nMind you we are using ",(0,n.jsx)(s.a,{href:"https://hackage.haskell.org/package/tasty",children:(0,n.jsx)(s.code,{children:"tasty"})})," to write tests."]})}),"\n",(0,n.jsxs)(s.p,{children:["Our objective here would be to write test cases for one of two main operations\nfrom the ",(0,n.jsx)(s.code,{children:"bet-ref"})," example - namely for placing bet operation."]}),"\n",(0,n.jsxs)(s.p,{children:["The test-suite given can be executed with ",(0,n.jsx)(s.code,{children:"cabal run betref-tests"})," command. Do note that, in the initial setup, you would notice an initial test failure, this is due to a quirk in the workings of ",(0,n.jsx)(s.a,{href:"https://github.com/IntersectMBO/cardano-node/tree/master/cardano-testnet",children:(0,n.jsx)(s.code,{children:"cardano-testnet"})})," when spinning up private testnet and should be ignored. Note that before running this command, make sure that you have required version of ",(0,n.jsx)(s.code,{children:"cardano-cli"})," & ",(0,n.jsx)(s.code,{children:"cardano-node"})," installed and available inside your path, use ",(0,n.jsx)(s.code,{children:"cabal install --package-env=$(pwd) --overwrite-policy=always cardano-cli cardano-node"})," from the root of the ",(0,n.jsx)(s.code,{children:"atlas-examples"})," repository to achieve that."]}),"\n",(0,n.jsx)(s.h3,{id:"testing-environment",children:"Testing environment"}),"\n",(0,n.jsxs)(s.p,{children:["Unified testing hides implementation details specific to ledger backends under\na layer of abstraction. Regardless of the backend we ultimately choose there is\n",(0,n.jsx)(s.code,{children:"TestInfo"})," datatype that provides access to user wallets among other things.\nA wallet is represented by ",(0,n.jsx)(s.code,{children:"User"})," datatype that holds signing keys, address,\nand collateral to use:"]}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"data"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"TestInfo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" TestInfo"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  { testGoldAsset "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"!GYAssetClass"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  , testIronAsset "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"!GYAssetClass"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  , testWallets "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"!Wallets"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" }"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"data"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Wallets"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" Wallets"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    { w1 "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"!User"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" more eighth wallets "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"data"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"User"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" User"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    { userPaymentSKey     "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"!GYPaymentSigningKey"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    , userStakeSKey       "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"!"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Maybe"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYStakeSigningKey"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    , userAddresses       "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"!"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"NonEmpty"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYAddress"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    , userChangeAddress   "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"!GYAddress"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    , userCollateral      "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Maybe"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"UserCollateral"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})})]})}),"\n",(0,n.jsxs)(s.p,{children:["Every wallet in ",(0,n.jsx)(s.code,{children:"Wallets"})," will be funded with an initial set of assets:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Million ADA."}),"\n",(0,n.jsxs)(s.li,{children:["Million ",(0,n.jsx)(s.code,{children:"fakeGold"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:["Million ",(0,n.jsx)(s.code,{children:"fakeIron"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"fakeGold"})," and ",(0,n.jsx)(s.code,{children:"fakeIron"})," are testing Cardano native assets that might be useful\n(though you can ignore them safely)."]}),"\n",(0,n.jsxs)(s.p,{children:["In previous sections, we got acquainted with several monads available in Atlas\nnamely ",(0,n.jsx)(s.code,{children:"GYTxQueryMonad"})," and ",(0,n.jsx)(s.code,{children:"GYTxMonad"})," that allowed us to query the blockchain\nand to construct transactions. Now it's time to introduce another monad that\nfacilitates testing - ",(0,n.jsx)(s.code,{children:"GYTxGameMonad"}),". Its most important action is called\n",(0,n.jsx)(s.code,{children:"asUser"})," and allows to run computations in ",(0,n.jsx)(s.code,{children:"GYTxMonad"})," using a particular\nwallet (signature is slightly simplified):"]}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsx)(s.code,{"data-language":"haskell","data-theme":"default",children:(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"asUser"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"User"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxMonad"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" a "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m a"})]})})}),"\n",(0,n.jsxs)(s.p,{children:["We conventionally call actions in ",(0,n.jsx)(s.code,{children:"GYTxGameMonad"}),' "runners" since they run some\noperations by submitting them under a particular user. We will see examples soon.']}),"\n",(0,n.jsx)(s.p,{children:"Then we have two functions that allow us to make a test case for a particular\nbackend out of a runner (the signature again is slightly modified here):"}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"mkTestFor"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"TestName"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"TestInfo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxGameMonad"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" a) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"TestTree"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"mkPrivnetTestFor"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Setup"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"TestName"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  ("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"TestInfo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxGameMonad"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" a) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"TestTree"})]})]})}),"\n",(0,n.jsxs)(s.p,{children:["Both functions take a name for a test case and a continuation function of type\n",(0,n.jsx)(s.code,{children:"TestInfo -> GYTxGameMonad a"}),". Then they internally generate the environment to\ndo the job. The difference is that ",(0,n.jsx)(s.code,{children:"mkPrivnetTestFor"})," also takes a value of type\n",(0,n.jsx)(s.code,{children:"Setup"})," that contains information about an instance of a private network.\nThis highlights an important distinction between them:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"mkTestFor"})," spawns a new instance of the emulator on every call - that way\nall test cases will be given with a fresh (new) blockchain ledger state having\nthe above balances to those 9 wallets."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"mkPrivnetTestFor"})," is supposed to be run inside a helper function\n",(0,n.jsx)(s.code,{children:"withPrivnet"})," which spins up a private testnet according to the configuration\nprovided and calls a series of test cases (i.e. the whole test suite) against it."]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["Let's use these bits to build various test cases for operations\nwithin ",(0,n.jsx)(s.code,{children:"bet-ref"})," example."]}),"\n",(0,n.jsx)(s.h3,{id:"defining-runner-for-bet-placing-operation",children:"Defining runner for bet placing operation"}),"\n",(0,n.jsxs)(s.p,{children:["Let's start with the runner to test ",(0,n.jsx)(s.code,{children:"placeBet"})," operation. We won't see anything\nnew here. It just uses ",(0,n.jsx)(s.code,{children:"asUser action"})," we just learned to run the operation.\nWe need values of all arguments that our operation takes. We cannot know them, so\nwe just take all of them as arguments to the runner itself, except the address as\nit can be obtained using ",(0,n.jsx)(s.a,{href:"https://haddock.atlas-app.io/GeniusYield-TxBuilder-Class.html#v:ownAddresses",children:(0,n.jsx)(s.code,{children:"ownAddresses"})})," function. This function  gives back all\nthe addresses of the wallet (",(0,n.jsx)(s.code,{children:"User"}),") that we provide to ",(0,n.jsx)(s.code,{children:"asUser"}),".\nOnce we get the result of the operation, we can build, sign, and submit a transaction.\nHere, again, the wallet we specified to ",(0,n.jsx)(s.code,{children:"asUser"})," action is used to sign it\n(though you can add additional signatures manually).\nLet's take a look at the code (you can find the full version in the sources,\nhere it's slightly redacted for simplicity)."]}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- | Run to call the `placeBet` operation."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"runPlaceBet"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxGameMonad"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m                   "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- We write runners in `GYTxGameMonad` monad"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxOutRef"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Script output reference"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"BetRefParams"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                      "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Parameters"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"OracleAnswerDatum"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                 "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Bet guess"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYValue"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                           "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Bet value"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Maybe"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxOutRef"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Ref output with existing bets"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"User"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                              "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ User that plays bet"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxId"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"runPlaceBet refScript brp guess bet mPrevBets user "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  asUser user "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"do"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Get the address"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    addr "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" maybeM (throwAppError "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" someBackendError "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"No own addresses"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      pure  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" listToMaybe "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<$>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ownAddresses"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Call the operation"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    skeleton "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" placeBet refScript brp guess bet addr mPrevBets"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Submit the transaction"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    buildTxBody skeleton "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" signAndSubmitConfirmed"})]})]})}),"\n",(0,n.jsx)(s.h3,{id:"additional-runners",children:"Additional runners"}),"\n",(0,n.jsx)(s.p,{children:"Let's take a look at the arguments our runner takes:"}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"runPlaceBet"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxOutRef"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Script output reference"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"BetRefParams"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                      "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Parameters"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"OracleAnswerDatum"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                 "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Bet guess"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYValue"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                           "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Bet value"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Maybe"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxOutRef"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Ref output with existing bets"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"User"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                              "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ User that plays bet"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxId"})]})]})}),"\n",(0,n.jsxs)(s.p,{children:["Bet guess, value, existing bets, and the user that plays a bet pertain to the\ntest case, so we should somehow pick or generate values for them\n(we will just use some sensible values in this example).\nBut the first argument of type ",(0,n.jsx)(s.code,{children:"GYTxOutRef"})," can't seem to be easy to know.\nIt's the transaction output reference (transaction hash and output index number)\nthat should contain a reference script on the ledger. To create it we need to build\nand submit another transaction."]}),"\n",(0,n.jsxs)(s.p,{children:["So we need another runner that applies the script to arguments, builds a transaction\nthat will deploy it, sign and submits it. Let's pretend we don't have such an operation\nto build a transaction to deploy within our application but what we have is\na function that makes the script. Notice the use ",(0,n.jsx)(s.code,{children:"GYTxQueryMonad"})," here since all that function\nneeds is only to figure out the current slot in the ledger to make the calculations:"]}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- | Queries the current slot, calculates the parameters, and builds"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- a script that is ready to be deployed."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"mkScript"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxQueryMonad"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Integer"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ How many slots betting should be open"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Integer"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ How many slots should pass before oracle reveals answer"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYPubKeyHash"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Oracle PKH"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYValue"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Bet step value"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m ("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"BetRefParams"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYScript"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"PlutusV2"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"mkScript betUntil betReveal oraclePkh betStep "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"do"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" [the body is omitted] "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."})]})]})}),"\n",(0,n.jsxs)(s.p,{children:["It takes several parameters that define the process of betting,\ndoes some calculations, and gives us back all the parameters of type ",(0,n.jsx)(s.code,{children:"BetRefParams"}),"\nand also ",(0,n.jsx)(s.code,{children:"GYScript PlutusV2"})," which is the script we can deploy. So in this case\nwe have to build the transaction directly within the runner. Fortunately,\nwe can use ",(0,n.jsx)(s.code,{children:"addRefScript"})," function that does exactly what we need:"]}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- | Runner to build and submit a transaction that deploys the reference script."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"runDeployScript"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxGameMonad"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Integer"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Bet Until slot"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Integer"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Bet Reveal slot"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYValue"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Bet step value"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Wallets"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m ("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"BetRefParams"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxOutRef"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"runDeployScript betUntil betReveal betStep ws "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"do"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  (params"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" script) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" mkScript betUntil betReveal (userPkh "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" oracle ws) betStep"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  asUser (admin ws) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"do"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" sAddr "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" userAddr (holder ws)"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    refScript "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" addRefScript sAddr script"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    pure (params"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" refScript)"})]})]})}),"\n",(0,n.jsxs)(s.p,{children:["This runner doesn't call any application operations, but now we can run it\nbefore our main runner ",(0,n.jsx)(s.code,{children:"runPlaceBet"})," since it returns both ",(0,n.jsx)(s.code,{children:"BetRefParams"}),"\nand ",(0,n.jsx)(s.code,{children:"GYTxOutRef"})," we need to call the main runner and ultimately ",(0,n.jsx)(s.code,{children:"placeBet"}),"\noperation."]}),"\n",(0,n.jsx)(s.h3,{id:"place-first-bet-test",children:"Place first bet test"}),"\n",(0,n.jsxs)(s.p,{children:["Now we are finally ready to write our first test.\nIt should first use ",(0,n.jsx)(s.code,{children:"runDeployScript"})," to calculate and deploy the script\nand then run the main runner ",(0,n.jsx)(s.code,{children:"runPlaceBet"}),"\nchecking that a transaction goes through and the balance of the user\nthat submits it gets smaller accordingly\n(of course, we could imagine other checks as well)."]}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- | Test for placing the first bet."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"firstBetTest"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxGameMonad"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Integer"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Integer"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYValue"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"OracleAnswerDatum"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYValue"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"TestInfo"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"()"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"firstBetTest betUntil betReveal betStep dat bet (testWallets "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ws"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"Wallets{w1}) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"do"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  (brp"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" refScript) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" runDeployScript betUntil betReveal betStep ws"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  withWalletBalancesCheckSimple [w1 "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueNegate bet] "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"do"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    void "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" runPlaceBet refScript brp dat bet Nothing w1"})]})]})}),"\n",(0,n.jsxs)(s.p,{children:["The code almost verbatim repeats what we just said using the function ",(0,n.jsx)(s.a,{href:"https://haddock.atlas-app.io/GeniusYield-Test-FeeTracker.html#v:withWalletBalancesCheckSimple",children:(0,n.jsx)(s.code,{children:"withWalletBalancesCheckSimple"})}),(0,n.jsx)(s.sup,{children:(0,n.jsx)(s.a,{href:"#user-content-fn-1",id:"user-content-fnref-1","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})}),".\nIt allows checking the change of wallet's balance with no caring about transaction and storage fees\n(the latter is also known as minimal ADA - the number of coins that should accompany Cardano native tokens).\nThis convenience is possible because Atlas manages its own record of\nall fees that were spent over the course of tests, so they can be accounted\nautomatically. This way we just provide the expected delta in balance by negating\nbet's value. More precisely this function takes a list of tuples",(0,n.jsx)(s.sup,{children:(0,n.jsx)(s.a,{href:"#user-content-fn-2",id:"user-content-fnref-2","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"2"})})," where the first element\nof the tuple is the wallet and the second element denotes the difference in\nthe wallet's value which we expect after the execution of the operation\ndefined inside its ",(0,n.jsx)(s.code,{children:"do"})," block.\nHere we want the balance of wallet 1 (which is the one calling this operation)\nto decrease with the bet amount and also the fees."]}),"\n",(0,n.jsx)(s.p,{children:"We specify all parameters when defining a test case:"}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"placeBetTests"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"TestTree"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"placeBetTests "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" testGroup "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Place Bet (Emulator)"'})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    [ mkTestFor "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Balance checks after placing first bet"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" firstBetTest'"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    ]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"firstBetTest'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxGameMonad"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"TestInfo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"()"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"firstBetTest' "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" firstBetTest"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"40"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"100"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  (valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"200_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  (OracleAnswerDatum "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"3"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  (valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"20_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})}),"\n",(0,n.jsx)(s.h3,{id:"multiple-bets-test",children:"Multiple bets test"}),"\n",(0,n.jsx)(s.p,{children:"Now let's write a slightly more involved test. This time we want to make sure\nthat many bets placed in a raw using different wallets can be submitted and the\nbalances of the wallets change accordingly."}),"\n",(0,n.jsx)(s.p,{children:"Let's start with defining some additional type aliases to save up space:"}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- This is an alias for fields of `Wallet` datatype"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"type"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Wallet"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Wallets"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"User"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- This type represent a bet made by a wallet"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"type"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Bet"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Wallet"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"OracleAnswerDatum"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYValue"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})}),"\n",(0,n.jsxs)(s.p,{children:["Now we want to write a function ",(0,n.jsx)(s.code,{children:"mkMultipleBetsTest"}),", we can pass a list\nof concrete bets to build a test case:"]}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"multipleBetsTest"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxGameMonad"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"TestInfo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"()"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"multipleBetsTest TestInfo{..} "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" mkMultipleBetsTest"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"400"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"10_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- game params"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- list of bets"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  [ (w1"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" OracleAnswerDatum "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"10_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (w2"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" OracleAnswerDatum "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"20_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (w3"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" OracleAnswerDatum "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"3"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"30_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (w2"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" OracleAnswerDatum "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"4"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"50_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (w4"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" OracleAnswerDatum "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"5"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"65_000_000"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                                "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueSingleton testGoldAsset "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  ]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  testWallets"})})]})}),"\n",(0,n.jsx)(s.p,{children:"As usual, let's commence with a runner. We already have a runner for placing a\nsingle bet so we can reuse it:"}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- | Runner for multiple bets."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"runMultipleBets"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxGameMonad"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"BetRefParams"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxOutRef"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                 "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Reference script"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Bet"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"]"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Wallets"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"()"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"runMultipleBets brp refScript bets ws "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" go bets True"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"where"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    go "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"[]"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" _ "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" return "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"()"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    go ((getWallet"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" dat"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" bet) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" remBets) isFirst "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"do"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" isFirst "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"then"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"do"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        gyLogInfo' "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"placing the first bet"'})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        void "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" runPlaceBet refScript brp dat bet Nothing (getWallet ws)"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        go remBets False"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"do"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        gyLogInfo' "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"placing a next bet"'})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- need to get previous bet utxo"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        betRefAddr "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" betRefAddress brp"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        GYUTxO{utxoRef} "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" head "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" utxosToList "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<$>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" utxosAtAddress betRefAddr Nothing"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        gyLogDebug' "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" printf "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"previous bet utxo: %s"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" utxoRef"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        void "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" runPlaceBet refScript brp dat bet (Just utxoRef) (getWallet ws)"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        go remBets False"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "})]})}),"\n",(0,n.jsxs)(s.p,{children:["The runner recursively traverses the list of bets, calling ",(0,n.jsx)(s.code,{children:"runPlaceBet"})," on every\nelement, indicating whether it is the first element or not using the last\nparameter of ",(0,n.jsx)(s.code,{children:"go"}),". Once we have the runner at hand we can write the test. We are\ngoing to skip some details to handle balances, you can find the full version in\nthe source code."]}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- | Makes a test case for placing multiple bets."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"mkMultipleBetsTest"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxGameMonad"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Integer"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                 "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Number of slots for betting"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Integer"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                 "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Number of slots for revealing"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYValue"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                 "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Bet step"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Bet"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"]                   "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ List denoting the bets"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Wallets"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                 "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- ^ Wallets available"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"()"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"mkMultipleBetsTest betUntil betReveal betStep bets ws "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"do"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Deploy script"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  (brp"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" refScript) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" runDeployScript betUntil betReveal betStep ws"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Get the balance"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  balanceBefore "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" getBalance"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  gyLogDebug' "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" printf "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"balanceBeforeAllTheseOps: %s"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (mconcat balanceBefore)"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Run operations"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  runMultipleBets brp refScript bets ws"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Get the balance again"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  balanceAfter "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" getBalance"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  gyLogDebug' "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" printf "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"balanceAfterAllTheseOps: %s"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (mconcat balanceAfter)"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Check the difference"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  verify "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" zip3"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    walletsAndBets"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    balanceBefore"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    balanceAfter"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"where"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" some balance"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"related functions are omitted here "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"    -- | Function to verify that the wallet indeed lost by /roughly/ the bet amount."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"    -- We say /roughly/ as fees is assumed to be within (0, 1 ada]."})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"verify"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxGameMonad"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" [(("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"User"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYValue"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYValue"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYValue"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")] "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"()"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    verify "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"[]"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" return "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"()"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    verify (((wallet"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" diff)"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" vBefore"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" vAfter) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" xs) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" vAfterWithoutFees "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" vBefore "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" diff"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"          (expectedAdaWithoutFees"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" expectedOtherAssets) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueSplitAda vAfterWithoutFees"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"          (actualAda"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" actualOtherAssets) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueSplitAda vAfter"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"          threshold "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- 1 ada"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" expectedOtherAssets "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" actualOtherAssets"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"&&"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" actualAda "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" expectedAdaWithoutFees"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"&&"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" expectedAdaWithoutFees "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" threshold "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" actualAda"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"then"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" verify xs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"          throwAppError "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" someBackendError "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" T.pack "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            printf "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"For wallet %s expected value (without fees) %s but actual is %s"'})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"              (show "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" userAddr wallet)"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"              (show vAfterWithoutFees)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"              (show vAfter)"})})]})}),"\n",(0,n.jsx)(s.h3,{id:"writing-negative-tests",children:"Writing negative tests"}),"\n",(0,n.jsxs)(s.p,{children:["But sometimes we want a test to fail! What happens if the newly placed bet is\nnot more than at least ",(0,n.jsx)(s.code,{children:"brpBetStep"})," amount? What happens if the transaction\nskeleton is somewhat wrong, say we didn't put ",(0,n.jsx)(s.code,{children:"mustBeSignedBy"}),"? What if someone\ntries to place a bet after ",(0,n.jsx)(s.code,{children:"brpBetUntil"}),"? What if..."]}),"\n",(0,n.jsx)(s.p,{children:"Let's add another test:"}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"failingMultipleBetsTest"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GYTxGameMonad"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"TestInfo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" m "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"()"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"failingMultipleBetsTest TestInfo{..} "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" mkMultipleBetsTest"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"400"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"10_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  [ (w1"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" OracleAnswerDatum "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"10_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (w2"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" OracleAnswerDatum "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"20_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (w3"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" OracleAnswerDatum "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"3"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"30_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (w2"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" OracleAnswerDatum "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"4"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"50_000_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (w4"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" OracleAnswerDatum "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"5"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueFromLovelace "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"55_000_000"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                                "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" valueSingleton testGoldAsset "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1_000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  ]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  testWallets"})})]})}),"\n",(0,n.jsxs)(s.p,{children:["If we run it we will get an error, since the last bet doesn't respect the minimal\nbet step which is ",(0,n.jsx)(s.code,{children:"10_000_000"})," lovelaces. Well for all such cases, we can assert\nthat a given trace must fail. It's done slightly differently for the emulator and\na private test network. For the emulator we just use ",(0,n.jsx)(s.code,{children:"mustFail"}),":"]}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"placeBetTestsClb"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"TestTree"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"placeBetTestsClb "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" testGroup "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Place bet"'})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    [ mkTestFor "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Multiple bets - to small step"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" mustFail "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" failingMultipleBetsTest"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    ]"})})]})}),"\n",(0,n.jsx)(s.p,{children:"For a private testnet it's more wordy:"}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"placeBetTests"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Setup"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"TestTree"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"placeBetTests setup "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" testGroup "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Place bet"'})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    [ mkPrivnetTestFor' "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Multiple bets - too small step"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" GYDebug setup "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"$"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        handleError"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"          ("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"\\case"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"              GYBuildTxException GYBuildTxBodyErrorAutoBalance {} "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pure "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"()"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"              e "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" throwError e"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"          )"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" failingMultipleBetsTest"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    ]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "})]})}),"\n",(0,n.jsx)(s.p,{children:"This section concludes our journey to testing dApps with Atlas."}),"\n","\n",(0,n.jsxs)(s.section,{"data-footnotes":!0,className:"footnotes",children:[(0,n.jsx)(s.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{id:"user-content-fn-1",children:["\n",(0,n.jsxs)(s.p,{children:["If you were to have fine-grained control over balance change, use ",(0,n.jsx)(s.a,{href:"https://haddock.atlas-app.io/GeniusYield-Test-Utils.html#v:withWalletBalancesCheck",children:(0,n.jsx)(s.code,{children:"withWalletBalancesCheck"})})," instead. ",(0,n.jsx)(s.a,{href:"#user-content-fnref-1","data-footnote-backref":!0,className:"data-footnote-backref","aria-label":"Back to content",children:"↩"})]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{id:"user-content-fn-2",children:["\n",(0,n.jsxs)(s.p,{children:["To convey the message better, we have a defined ",(0,n.jsx)(s.a,{href:"https://haddock.atlas-app.io/GeniusYield-Test-Utils.html#v::-61-",children:(0,n.jsx)(s.code,{children:"(:=)"})})," pattern synonym:"]}),"\n",(0,n.jsx)(s.pre,{"data-language":"haskell","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"haskell","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"pattern"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (:=) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"::"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" x "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" y "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (x"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" y)"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"pattern"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:":="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") x y "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (x"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" y)"})]})]})}),"\n",(0,n.jsx)(s.a,{href:"#user-content-fnref-2","data-footnote-backref":!0,className:"data-footnote-backref","aria-label":"Back to content",children:"↩"}),"\n"]}),"\n"]}),"\n"]})]})}let d={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,i.a)(),e.components);return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(h,{...e})}):h(e)},pageOpts:{filePath:"src/pages/getting-started/testing.mdx",route:"/getting-started/testing",timestamp:1734588242e3,pageMap:[{kind:"Meta",data:{index:{title:"Atlas",display:"hidden",theme:{layout:"raw"}},documentation:{title:"Documentation",type:"page",href:"/introduction"},introduction:"Introduction","getting-started":"Getting Started","additional-features":"Additional Features","more-tutorials":"More Tutorials",haddock:{title:"API Reference (Haddock) ⬈",href:"https://haddock.atlas-app.io/",newWindow:!0}}},{kind:"Folder",name:"additional-features",route:"/additional-features",children:[{kind:"Meta",data:{blueprint:"Blueprint","simple-scripts":"Simple Scripts"}},{kind:"MdxPage",name:"blueprint",route:"/additional-features/blueprint"},{kind:"MdxPage",name:"simple-scripts",route:"/additional-features/simple-scripts"}]},{kind:"Folder",name:"getting-started",route:"/getting-started",children:[{kind:"Meta",data:{"how-to-build":"How to build?","smart-contract-intro":"Smart Contract",operations:"Operations over Contract",testing:"Testing",endpoints:"Creating Endpoints","browser-integration":"Browser Integration","unit-tests":{display:"hidden",title:"Unit Tests"},"integration-tests":{display:"hidden",title:"Integration Tests"}}},{kind:"MdxPage",name:"browser-integration",route:"/getting-started/browser-integration"},{kind:"MdxPage",name:"endpoints",route:"/getting-started/endpoints"},{kind:"MdxPage",name:"how-to-build",route:"/getting-started/how-to-build"},{kind:"MdxPage",name:"integration-tests",route:"/getting-started/integration-tests"},{kind:"MdxPage",name:"operations",route:"/getting-started/operations"},{kind:"MdxPage",name:"smart-contract-intro",route:"/getting-started/smart-contract-intro"},{kind:"MdxPage",name:"testing",route:"/getting-started/testing"},{kind:"MdxPage",name:"unit-tests",route:"/getting-started/unit-tests"}]},{kind:"MdxPage",name:"getting-started",route:"/getting-started"},{kind:"MdxPage",name:"index",route:"/"},{kind:"MdxPage",name:"introduction",route:"/introduction"},{kind:"MdxPage",name:"more-tutorials",route:"/more-tutorials"}],flexsearch:{codeblocks:!0},title:"Testing",headings:c},pageNextRoute:"/getting-started/testing",nextraLayout:o.ZP,themeConfig:t.Z};s.default=(0,r.j)(d)},9296:function(e,s,l){"use strict";l.d(s,{Z:function(){return h}});var n=l(5893);l(7294);var r=l(5675),o=l.n(r),t={src:"/_next/static/media/atlas-logo-light-mode.6077cdd3.svg",height:320,width:937,blurWidth:0,blurHeight:0},i={src:"/_next/static/media/atlas-logo-dark-mode.62b4f6dd.svg",height:320,width:945,blurWidth:0,blurHeight:0},a=l(2010),c=l(1163),h={logo:(0,n.jsx)(()=>{let{resolvedTheme:e}=(0,a.F)();return(0,n.jsx)(o(),{src:"light"===e?t:i,alt:"Atlas Logo",height:"42"})},{}),project:{link:"https://github.com/geniusyield/atlas"},docsRepositoryBase:"https://github.com/geniusyield/atlas-docs/tree/main",useNextSeoProps(){let{asPath:e}=(0,c.useRouter)(),s="All-in-one solution for writing off-chain code for Plutus contracts";return{titleTemplate:"/"===e?"ATLAS Plutus Application Backend | by Genius Yield":"Atlas | %s",description:s,canonical:"https://atlas-app.io",openGraph:{url:"https://atlas-app.io",description:s,images:[{url:"/open-graph.png",width:1200,height:630,alt:"Atlas - Application backend for Plutus smart contracts on Cardano",type:"image/png"}]},siteName:"Atlas",twitter:{handle:"@GeniusyieldO",site:"https://www.geniusyield.co",cardType:"summary_large_image"}}},head:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("link",{rel:"apple-touch-icon",sizes:"180x180",href:"/favicon/apple-touch-icon.png"}),(0,n.jsx)("link",{rel:"icon",type:"image/png",sizes:"32x32",href:"/favicon/favicon-32x32.png"}),(0,n.jsx)("link",{rel:"icon",type:"image/png",sizes:"16x16",href:"/favicon/favicon-16x16.png"}),(0,n.jsx)("link",{rel:"manifest",href:"/favicon/site.webmanifest"}),(0,n.jsx)("link",{rel:"mask-icon",href:"/favicon/safari-pinned-tab.svg",color:"#5bbad5"}),(0,n.jsx)("link",{rel:"shortcut icon",href:"/favicon/favicon.ico"}),(0,n.jsx)("meta",{name:"msapplication-TileColor",content:"#da532c"}),(0,n.jsx)("meta",{name:"msapplication-config",content:"/favicon/browserconfig.xml"}),(0,n.jsx)("meta",{name:"theme-color",content:"#ffffff"})]}),footer:{component:(0,n.jsx)(n.Fragment,{})},nextThemes:{defaultTheme:"dark"},darkMode:!1,sidebar:{toggleButton:!0}}},5789:function(){}},function(e){e.O(0,[526,888,774,179],function(){return e(e.s=9459)}),_N_E=e.O()}]);