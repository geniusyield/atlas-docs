<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Atlas | Creating Endpoints</title><meta name="robots" content="index,follow"/><meta name="description" content="All-in-one solution for writing off-chain code for Plutus contracts"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://www.geniusyield.co"/><meta name="twitter:creator" content="@GeniusyieldO"/><meta property="og:title" content="Atlas | Creating Endpoints"/><meta property="og:description" content="All-in-one solution for writing off-chain code for Plutus contracts"/><meta property="og:url" content="https://atlas-app.io"/><meta property="og:image" content="/open-graph.png"/><meta property="og:image:alt" content="Atlas - Application backend for Plutus smart contracts on Cardano"/><meta property="og:image:type" content="image/png"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><link rel="canonical" href="https://atlas-app.io"/><meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/><style>
        :root {
          --nextra-primary-hue: 212deg;
          --nextra-navbar-height: 4rem;
          --nextra-menu-height: 3.75rem;
          --nextra-banner-height: 2.5rem;
        }
        
        .dark {
          --nextra-primary-hue: 204deg;
        }
      </style><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#da532c"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#ffffff"/><meta name="next-head-count" content="27"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/2e27e0463af74fb7.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2e27e0463af74fb7.css" data-n-g=""/><link rel="preload" href="/_next/static/css/0cc96501534ae786.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0cc96501534ae786.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-1eed7d0cad797102.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-eabb9cd1fd0dca10.js" defer=""></script><script src="/_next/static/chunks/pages/_app-fb67b7bfc2099242.js" defer=""></script><script src="/_next/static/chunks/783-649966bc7444d13f.js" defer=""></script><script src="/_next/static/chunks/pages/getting-started/endpoints-7c10df33f03af3f5.js" defer=""></script><script src="/_next/static/ux_KgcFslnSxR-Abq8Hmw/_buildManifest.js" defer=""></script><script src="/_next/static/ux_KgcFslnSxR-Abq8Hmw/_ssgManifest.js" defer=""></script></head><body><div id="__next"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div dir="ltr"><script>document.documentElement.setAttribute('dir','ltr')</script><div class="nextra-nav-container nx-sticky nx-top-0 nx-z-20 nx-w-full nx-bg-transparent"><div class="nextra-nav-container-blur nx-pointer-events-none nx-absolute nx-z-[-1] nx-h-full nx-w-full nx-bg-white dark:nx-bg-dark nx-shadow-[0_2px_4px_rgba(0,0,0,.02),0_1px_0_rgba(0,0,0,.06)] dark:nx-shadow-[0_-1px_0_rgba(255,255,255,.1)_inset] contrast-more:nx-shadow-[0_0_0_1px_#000] contrast-more:dark:nx-shadow-[0_0_0_1px_#fff]"></div><nav class="nx-mx-auto nx-flex nx-h-[var(--nextra-navbar-height)] nx-max-w-[90rem] nx-items-center nx-justify-end nx-gap-2 nx-pl-[max(env(safe-area-inset-left),1.5rem)] nx-pr-[max(env(safe-area-inset-right),1.5rem)]"><a class="nx-flex nx-items-center hover:nx-opacity-75 ltr:nx-mr-auto rtl:nx-ml-auto" href="/"><img alt="Atlas Logo" loading="lazy" width="124" height="42" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/atlas-logo-dark-mode.62b4f6dd.svg"/></a><a class="nx-text-sm contrast-more:nx-text-gray-700 contrast-more:dark:nx-text-gray-100 nx-relative -nx-ml-2 nx-hidden nx-whitespace-nowrap nx-p-2 md:nx-inline-block nx-font-medium nx-subpixel-antialiased" aria-current="true" href="/introduction"><span class="nx-absolute nx-inset-x-0 nx-text-center">Documentation</span><span class="nx-invisible nx-font-medium">Documentation</span></a><div class="nextra-search nx-relative md:nx-w-64 nx-hidden md:nx-inline-block mx-min-w-[200px]"><div class="nx-relative nx-flex nx-items-center nx-text-gray-900 contrast-more:nx-text-gray-800 dark:nx-text-gray-300 contrast-more:dark:nx-text-gray-300"><input spellcheck="false" class="nx-block nx-w-full nx-appearance-none nx-rounded-lg nx-px-3 nx-py-2 nx-transition-colors nx-text-base nx-leading-tight md:nx-text-sm nx-bg-black/[.05] dark:nx-bg-gray-50/10 focus:nx-bg-white dark:focus:nx-bg-dark placeholder:nx-text-gray-500 dark:placeholder:nx-text-gray-400 contrast-more:nx-border contrast-more:nx-border-current" type="search" placeholder="Search documentationâ€¦" value=""/></div></div><a href="https://github.com/geniusyield/atlas-docs" target="_blank" rel="noreferrer" class="nx-p-2 nx-text-current"><svg width="24" height="24" fill="currentColor" viewBox="3 3 18 18"><title>GitHub</title><path d="M12 3C7.0275 3 3 7.12937 3 12.2276C3 16.3109 5.57625 19.7597 9.15374 20.9824C9.60374 21.0631 9.77249 20.7863 9.77249 20.5441C9.77249 20.3249 9.76125 19.5982 9.76125 18.8254C7.5 19.2522 6.915 18.2602 6.735 17.7412C6.63375 17.4759 6.19499 16.6569 5.8125 16.4378C5.4975 16.2647 5.0475 15.838 5.80124 15.8264C6.51 15.8149 7.01625 16.4954 7.18499 16.7723C7.99499 18.1679 9.28875 17.7758 9.80625 17.5335C9.885 16.9337 10.1212 16.53 10.38 16.2993C8.3775 16.0687 6.285 15.2728 6.285 11.7432C6.285 10.7397 6.63375 9.9092 7.20749 9.26326C7.1175 9.03257 6.8025 8.08674 7.2975 6.81794C7.2975 6.81794 8.05125 6.57571 9.77249 7.76377C10.4925 7.55615 11.2575 7.45234 12.0225 7.45234C12.7875 7.45234 13.5525 7.55615 14.2725 7.76377C15.9937 6.56418 16.7475 6.81794 16.7475 6.81794C17.2424 8.08674 16.9275 9.03257 16.8375 9.26326C17.4113 9.9092 17.76 10.7281 17.76 11.7432C17.76 15.2843 15.6563 16.0687 13.6537 16.2993C13.98 16.5877 14.2613 17.1414 14.2613 18.0065C14.2613 19.2407 14.25 20.2326 14.25 20.5441C14.25 20.7863 14.4188 21.0746 14.8688 20.9824C16.6554 20.364 18.2079 19.1866 19.3078 17.6162C20.4077 16.0457 20.9995 14.1611 21 12.2276C21 7.12937 16.9725 3 12 3Z"></path></svg><span class="nx-sr-only">GitHub</span><span class="nx-sr-only"> (opens in a new tab)</span></a><a href="https://discord.gg/TNHf4fs626" target="_blank" rel="noreferrer" class="nx-p-2 nx-text-current"><svg width="24" height="24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 5 30.67 23.25"><title>Discord</title><path d="M26.0015 6.9529C24.0021 6.03845 21.8787 5.37198 19.6623 5C19.3833 5.48048 19.0733 6.13144 18.8563 6.64292C16.4989 6.30193 14.1585 6.30193 11.8336 6.64292C11.6166 6.13144 11.2911 5.48048 11.0276 5C8.79575 5.37198 6.67235 6.03845 4.6869 6.9529C0.672601 12.8736 -0.41235 18.6548 0.130124 24.3585C2.79599 26.2959 5.36889 27.4739 7.89682 28.2489C8.51679 27.4119 9.07477 26.5129 9.55525 25.5675C8.64079 25.2265 7.77283 24.808 6.93587 24.312C7.15286 24.1571 7.36986 23.9866 7.57135 23.8161C12.6241 26.1255 18.0969 26.1255 23.0876 23.8161C23.3046 23.9866 23.5061 24.1571 23.7231 24.312C22.8861 24.808 22.0182 25.2265 21.1037 25.5675C21.5842 26.5129 22.1422 27.4119 22.7621 28.2489C25.2885 27.4739 27.8769 26.2959 30.5288 24.3585C31.1952 17.7559 29.4733 12.0212 26.0015 6.9529ZM10.2527 20.8402C8.73376 20.8402 7.49382 19.4608 7.49382 17.7714C7.49382 16.082 8.70276 14.7025 10.2527 14.7025C11.7871 14.7025 13.0425 16.082 13.0115 17.7714C13.0115 19.4608 11.7871 20.8402 10.2527 20.8402ZM20.4373 20.8402C18.9183 20.8402 17.6768 19.4608 17.6768 17.7714C17.6768 16.082 18.8873 14.7025 20.4373 14.7025C21.9717 14.7025 23.2271 16.082 23.1961 17.7714C23.1961 19.4608 21.9872 20.8402 20.4373 20.8402Z"></path></svg><span class="nx-sr-only">Discord</span><span class="nx-sr-only"> (opens in a new tab)</span></a><button type="button" aria-label="Menu" class="nextra-hamburger -nx-mr-2 nx-rounded nx-p-2 active:nx-bg-gray-400/20 md:nx-hidden"><svg fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" class=""><g><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16"></path></g><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 12h16"></path><g><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 18h16"></path></g></svg></button></nav></div><div class="nx-mx-auto nx-flex nx-max-w-[90rem]"><div class="motion-reduce:nx-transition-none [transition:background-color_1.5s_ease] nx-bg-transparent"></div><aside class="nextra-sidebar-container nx-flex nx-flex-col md:nx-top-16 md:nx-shrink-0 motion-reduce:nx-transform-none nx-transform-gpu nx-transition-all nx-ease-in-out md:nx-w-64 md:nx-sticky md:nx-self-start max-md:[transform:translate3d(0,-100%,0)]"><div class="nx-px-4 nx-pt-4 md:nx-hidden"><div class="nextra-search nx-relative md:nx-w-64"><div class="nx-relative nx-flex nx-items-center nx-text-gray-900 contrast-more:nx-text-gray-800 dark:nx-text-gray-300 contrast-more:dark:nx-text-gray-300"><input spellcheck="false" class="nx-block nx-w-full nx-appearance-none nx-rounded-lg nx-px-3 nx-py-2 nx-transition-colors nx-text-base nx-leading-tight md:nx-text-sm nx-bg-black/[.05] dark:nx-bg-gray-50/10 focus:nx-bg-white dark:focus:nx-bg-dark placeholder:nx-text-gray-500 dark:placeholder:nx-text-gray-400 contrast-more:nx-border contrast-more:nx-border-current" type="search" placeholder="Search documentationâ€¦" value=""/></div></div></div><div class="nx-overflow-y-auto nx-p-4 nx-grow md:nx-h-[calc(100vh-var(--nextra-navbar-height)-3.75rem)] nextra-scrollbar"><div class="nx-transform-gpu nx-overflow-hidden nx-transition-all nx-ease-in-out motion-reduce:nx-transition-none"><div class="nx-p-2 nx-transition-opacity nx-duration-500 nx-ease-in-out motion-reduce:nx-transition-none nx-opacity-100"><ul class="nx-flex nx-flex-col nx-gap-1 max-md:nx-hidden"><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/introduction">Introduction</a></li><li class="open"><a class="nx-items-center nx-justify-between nx-gap-2 nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started">Getting Started<svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-h-[18px] nx-min-w-[18px] nx-rounded-sm nx-p-0.5 hover:nx-bg-gray-800/5 dark:hover:nx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="nx-origin-center nx-transition-transform rtl:-nx-rotate-180 ltr:nx-rotate-90 rtl:nx-rotate-[-270deg]"></path></svg></a><div class="nx-transform-gpu nx-overflow-hidden nx-transition-all nx-ease-in-out motion-reduce:nx-transition-none"><div class="nx-p-2 nx-transition-opacity nx-duration-500 nx-ease-in-out motion-reduce:nx-transition-none nx-opacity-100 ltr:nx-pr-0 rtl:nx-pl-0"><ul class="nx-flex nx-flex-col nx-gap-1 nx-relative before:nx-absolute before:nx-inset-y-1.5 before:nx-w-px before:nx-bg-gray-200 before:nx-content-[&quot;&quot;] dark:before:nx-bg-neutral-800 ltr:nx-pl-3 ltr:before:nx-left-0 rtl:nx-pr-3 rtl:before:nx-right-0 ltr:nx-ml-1 rtl:nx-mr-1"><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started/smart-contract-intro">Smart Contract</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started/operations">Operations over Contract</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started/unit-tests">Unit Tests</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started/integration-tests">Integration Tests</a></li><li class="nx-flex nx-flex-col nx-gap-1 active"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-bg-primary-50 nx-font-bold nx-text-primary-600 dark:nx-bg-primary-500/10 contrast-more:nx-border-primary-500 contrast-more:dark:nx-border-primary-500" href="/getting-started/endpoints">Creating Endpoints</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started/browser-integration">Browser Integration</a></li></ul></div></div></li></ul></div></div><ul class="nx-flex nx-flex-col nx-gap-1 md:nx-hidden"><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/introduction">Documentation</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/introduction">Introduction</a></li><li class="open"><a class="nx-items-center nx-justify-between nx-gap-2 nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started">Getting Started<svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-h-[18px] nx-min-w-[18px] nx-rounded-sm nx-p-0.5 hover:nx-bg-gray-800/5 dark:hover:nx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="nx-origin-center nx-transition-transform rtl:-nx-rotate-180 ltr:nx-rotate-90 rtl:nx-rotate-[-270deg]"></path></svg></a><div class="nx-transform-gpu nx-overflow-hidden nx-transition-all nx-ease-in-out motion-reduce:nx-transition-none"><div class="nx-p-2 nx-transition-opacity nx-duration-500 nx-ease-in-out motion-reduce:nx-transition-none nx-opacity-100 ltr:nx-pr-0 rtl:nx-pl-0"><ul class="nx-flex nx-flex-col nx-gap-1 nx-relative before:nx-absolute before:nx-inset-y-1.5 before:nx-w-px before:nx-bg-gray-200 before:nx-content-[&quot;&quot;] dark:before:nx-bg-neutral-800 ltr:nx-pl-3 ltr:before:nx-left-0 rtl:nx-pr-3 rtl:before:nx-right-0 ltr:nx-ml-1 rtl:nx-mr-1"><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started/smart-contract-intro">Smart Contract</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started/operations">Operations over Contract</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started/unit-tests">Unit Tests</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started/integration-tests">Integration Tests</a></li><li class="nx-flex nx-flex-col nx-gap-1 active"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-bg-primary-50 nx-font-bold nx-text-primary-600 dark:nx-bg-primary-500/10 contrast-more:nx-border-primary-500 contrast-more:dark:nx-border-primary-500" href="/getting-started/endpoints">Creating Endpoints</a><ul class="nx-flex nx-flex-col nx-gap-1 nx-relative before:nx-absolute before:nx-inset-y-1.5 before:nx-w-px before:nx-bg-gray-200 before:nx-content-[&quot;&quot;] dark:before:nx-bg-neutral-800 ltr:nx-pl-3 ltr:before:nx-left-0 rtl:nx-pr-3 rtl:before:nx-right-0 ltr:nx-ml-3 rtl:nx-mr-3"><li><a href="#providing-data-provider" class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-flex nx-gap-2 before:nx-opacity-25 before:nx-content-[&quot;#&quot;] nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50">Providing Data Provider</a></li><li><a href="#defining-endpoints" class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-flex nx-gap-2 before:nx-opacity-25 before:nx-content-[&quot;#&quot;] nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50">Defining Endpoints</a></li><li><a href="#submit-endpoint" class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-flex nx-gap-2 before:nx-opacity-25 before:nx-content-[&quot;#&quot;] nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50">Submit Endpoint</a></li></ul></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-500 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started/browser-integration">Browser Integration</a></li></ul></div></div></li></ul></div><div class="nx-sticky nx-bottom-0 nx-bg-white dark:nx-bg-dark nx-mx-4 nx-border-t nx-py-4 nx-shadow-[0_-12px_16px_#fff] nx-flex nx-items-center nx-gap-2 dark:nx-border-neutral-800 dark:nx-shadow-[0_-12px_16px_#111] contrast-more:nx-border-neutral-400 contrast-more:nx-shadow-none contrast-more:dark:nx-shadow-none"><div class="nx-relative"><button title="Change theme" class="nx-h-7 nx-rounded-md nx-px-2 nx-text-left nx-text-xs nx-font-medium nx-text-gray-600 nx-transition-colors dark:nx-text-gray-400 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50" id="headlessui-listbox-button-:Rlsr6:" type="button" aria-haspopup="listbox" aria-expanded="false" data-headlessui-state=""><div class="nx-flex nx-items-center nx-gap-2 nx-capitalize"><svg fill="none" viewBox="3 3 18 18" width="12" height="12" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" fill="currentColor" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg><span class="">light</span></div></button></div><button title="Hide sidebar" class="max-md:nx-hidden nx-h-7 nx-rounded-md nx-transition-colors nx-text-gray-600 dark:nx-text-gray-400 nx-px-2 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50"><svg height="12" width="12" viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" d="M4.177 7.823l2.396-2.396A.25.25 0 017 5.604v4.792a.25.25 0 01-.427.177L4.177 8.177a.25.25 0 010-.354z" class=""></path><path fill-rule="evenodd" d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0114.25 16H1.75A1.75 1.75 0 010 14.25V1.75zm1.75-.25a.25.25 0 00-.25.25v12.5c0 .138.112.25.25.25H9.5v-13H1.75zm12.5 13H11v-13h3.25a.25.25 0 01.25.25v12.5a.25.25 0 01-.25.25z"></path></svg></button></div></aside><nav class="nextra-toc nx-order-last nx-hidden nx-w-64 nx-shrink-0 xl:nx-block nx-px-4" aria-label="table of contents"><div class="nextra-scrollbar nx-sticky nx-top-16 nx-overflow-y-auto nx-pr-4 nx-pt-8 nx-text-sm [hyphens:auto] nx-max-h-[calc(100vh-var(--nextra-navbar-height)-env(safe-area-inset-bottom))] ltr:-nx-mr-4 rtl:-nx-ml-4"><p class="nx-mb-4 nx-font-semibold nx-tracking-tight">On This Page</p><ul><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#providing-data-provider" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50">Providing Data Provider</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#defining-provider-configuration" class="ltr:nx-ml-4 rtl:nx-mr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50">Defining Provider Configuration</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#parsing-given-configuration" class="ltr:nx-ml-4 rtl:nx-mr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50">Parsing Given Configuration</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#defining-endpoints" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50">Defining Endpoints</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#shared-context" class="ltr:nx-ml-4 rtl:nx-mr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50">Shared Context</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#submit-endpoint" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50">Submit Endpoint</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#transaction-building-endpoints" class="ltr:nx-ml-4 rtl:nx-mr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50">Transaction Building Endpoints</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#wrap-up" class="ltr:nx-ml-4 rtl:nx-mr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50">Wrap-Up</a></li></ul><div class="nx-mt-8 nx-border-t nx-bg-white nx-pt-8 nx-shadow-[0_-12px_16px_white] dark:nx-bg-dark dark:nx-shadow-[0_-12px_16px_#111] nx-sticky nx-bottom-0 nx-flex nx-flex-col nx-items-start nx-gap-2 nx-pb-8 dark:nx-border-neutral-800 contrast-more:nx-border-t contrast-more:nx-border-neutral-400 contrast-more:nx-shadow-none contrast-more:dark:nx-border-neutral-400"><a href="https://github.com/geniusyield/atlas-docs/issues/new?title=Feedback%20for%20%E2%80%9CCreating%20Endpoints%E2%80%9D&amp;labels=feedback" target="_blank" rel="noreferrer" class="nx-text-xs nx-font-medium nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-100 contrast-more:nx-text-gray-800 contrast-more:dark:nx-text-gray-50">Question? Give us feedback â†’<span class="nx-sr-only"> (opens in a new tab)</span></a><a class="nx-text-xs nx-font-medium nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-100 contrast-more:nx-text-gray-800 contrast-more:dark:nx-text-gray-50" href="https://github.com/geniusyield/atlas-docs/tree/main/src/pages/getting-started/endpoints.mdx">Edit this page</a></div></div></nav><div id="reach-skip-nav"></div><article class="nextra-content nx-flex nx-min-h-[calc(100vh-4rem)] nx-w-full nx-min-w-0 nx-max-w-full nx-justify-center nx-pb-8 nx-pr-[calc(env(safe-area-inset-right)-1.5rem)]"><main class="nx-w-full nx-min-w-0 nx-max-w-6xl nx-px-6 nx-pt-4 md:nx-px-12"><div class="nextra-breadcrumb nx-mt-2.5 nx-flex nx-items-center nx-gap-1 nx-overflow-hidden nx-text-sm nx-text-gray-500 contrast-more:nx-text-current"><div class="nx-whitespace-nowrap nx-transition-colors nx-min-w-[24px] nx-overflow-hidden nx-text-ellipsis hover:nx-text-gray-900 dark:hover:nx-text-gray-200" title="Getting Started"><a href="/getting-started">Getting Started</a></div><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-w-3.5 nx-shrink-0"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg><div class="nx-whitespace-nowrap nx-transition-colors nx-font-medium nx-text-gray-700 contrast-more:nx-font-bold contrast-more:nx-text-current dark:nx-text-gray-400 contrast-more:dark:nx-text-current" title="Creating Endpoints">Creating Endpoints</div></div><h1 class="nx-mt-2 nx-text-4xl nx-font-bold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100">Creating Endpoints</h1>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Now that we are confident with our smart contract, it&#x27;s time that we make it accessible to end user.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">The approach here would be that front-end will first ask us for the unsigned transaction body by giving us the relevant parameters needed to construct it. Then front-end will get this transaction body signed in browser to obtain signed transaction body which it will then submit either via browser wallet&#x27;s endpoint or via calling the submit endpoint which we will define here.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">We&#x27;ll use <a href="https://docs.servant.dev/en/stable/" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">Servant<span class="nx-sr-only"> (opens in a new tab)</span></a> to create our endpoints and one may understand it by following their easy to understand tutorial <a href="https://docs.servant.dev/en/stable/tutorial/index.html" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">here<span class="nx-sr-only"> (opens in a new tab)</span></a>.</p>
<div class="nextra-callout nx-mt-6 nx-flex nx-rounded-lg nx-border nx-py-2 ltr:nx-pr-4 rtl:nx-pl-4 contrast-more:nx-border-current contrast-more:dark:nx-border-current nx-border-orange-100 nx-bg-orange-50 nx-text-orange-800 dark:nx-border-orange-400/30 dark:nx-bg-orange-400/20 dark:nx-text-orange-300"><div class="nx-select-none nx-text-xl ltr:nx-pl-3 ltr:nx-pr-2 rtl:nx-pr-3 rtl:nx-pl-2" style="font-family:&quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;">ðŸ’¡</div><div class="nx-w-full nx-min-w-0 nx-leading-7"><p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Do note that we can also sign the transactions in server using the <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">signTx</code> function defined in <a href="https://github.com/geniusyield/atlas/tree/main/src/GeniusYield/Types/TxBody.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">TxBody.hs</code><span class="nx-sr-only"> (opens in a new tab)</span></a></p></div></div>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">Providing Data Provider<span class="nx-absolute -nx-mt-20" id="providing-data-provider"></span><a href="#providing-data-provider" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Defining Provider Configuration<span class="nx-absolute -nx-mt-20" id="defining-provider-configuration"></span><a href="#defining-provider-configuration" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">As noted earlier, building transaction bodies require gathering suitable information from the blockchain. For this purpose, we&#x27;ll require a provider. Atlas is unopinionated and allows user to plug in provider of their choice, including a locally hosted one.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Currently Atlas supports the following providers (&amp; it would be highly appreciated if community enriches this by contributing to <a href="https://github.com/geniusyield/atlas/tree/main" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">Atlas<span class="nx-sr-only"> (opens in a new tab)</span></a>):</p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2"><a href="https://www.gomaestro.org/" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">Maestro<span class="nx-sr-only"> (opens in a new tab)</span></a>.</li>
<li class="nx-my-2">Locally ran node.</li>
<li class="nx-my-2">Cardano DB Sync (but only for private network tests).</li>
</ul>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">To provide information about the provider, we will create a <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">config.json</code> file whose contents could be as follows:</p>
<div class="nextra-callout nx-mt-6 nx-flex nx-rounded-lg nx-border nx-py-2 ltr:nx-pr-4 rtl:nx-pl-4 contrast-more:nx-border-current contrast-more:dark:nx-border-current nx-border-orange-100 nx-bg-orange-50 nx-text-orange-800 dark:nx-border-orange-400/30 dark:nx-bg-orange-400/20 dark:nx-text-orange-300"><div class="nx-select-none nx-text-xl ltr:nx-pl-3 ltr:nx-pr-2 rtl:nx-pr-3 rtl:nx-pl-2" style="font-family:&quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;">ðŸ’¡</div><div class="nx-w-full nx-min-w-0 nx-leading-7"><p class="nx-mt-6 nx-leading-7 first:nx-mt-0">We have given a sample <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">config.json</code> file <a href="https://github.com/geniusyield/atlas-examples/tree/main/bet-ref/config.sample.json" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">here<span class="nx-sr-only"> (opens in a new tab)</span></a>.</p></div></div>
<button type="button" aria-hidden="true" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0"></button><div class="no-scrollbar -nx-m-2 nx-overflow-x-auto nx-overflow-y-hidden nx-overscroll-x-contain nx-p-2"><div class="nx-mt-4 nx-flex nx-w-max nx-min-w-full nx-border-b nx-border-gray-200 nx-pb-px dark:nx-border-neutral-800" role="tablist" aria-orientation="horizontal"><button class="nx-mr-2 nx-rounded-t nx-p-2 nx-font-medium nx-leading-5 nx-transition-colors -nx-mb-0.5 nx-select-none nx-border-b-2 nx-border-primary-500 nx-text-primary-600" id="headlessui-tabs-tab-:R5hiqb6:" role="tab" type="button" aria-selected="true" tabindex="0" data-headlessui-state="selected">Maestro</button><button class="nx-mr-2 nx-rounded-t nx-p-2 nx-font-medium nx-leading-5 nx-transition-colors -nx-mb-0.5 nx-select-none nx-border-b-2 nx-border-transparent nx-text-gray-600 hover:nx-border-gray-200 hover:nx-text-black dark:nx-text-gray-200 dark:hover:nx-border-neutral-800 dark:hover:nx-text-white" id="headlessui-tabs-tab-:R9hiqb6:" role="tab" type="button" aria-selected="false" tabindex="-1" data-headlessui-state="">Local Node</button></div></div><div><div class="nx-rounded nx-pt-6" id="headlessui-tabs-panel-:R6hiqb6:" role="tabpanel" tabindex="0" data-headlessui-state="selected"><div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-font-medium nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4 " data-language="json" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr" data-language="json" data-theme="default"><span class="line"><span style="color:var(--shiki-color-text)">{</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">&quot;coreProvider&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-color-text)"> { </span><span style="color:var(--shiki-token-keyword)">&quot;maestroToken&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;&lt;Your-API-Key&gt;&quot;</span><span style="color:var(--shiki-color-text)"> }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">&quot;networkId&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;testnet-preprod&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">&quot;logging&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-color-text)"> [{ </span><span style="color:var(--shiki-token-keyword)">&quot;type&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-color-text)"> { </span><span style="color:var(--shiki-token-keyword)">&quot;tag&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;stderr&quot;</span><span style="color:var(--shiki-color-text)"> }</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">&quot;severity&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;Debug&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">&quot;verbosity&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;V2&quot;</span><span style="color:var(--shiki-color-text)"> }]</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">&quot;utxoCacheEnable&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">false</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 " title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div></div><span id="headlessui-tabs-panel-:Rahiqb6:" role="tabpanel" tabindex="-1" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0"></span></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Here is the explaination for each of the JSON keys above:</p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2"><strong><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">coreProvider</code></strong>: This field is the differentiating factor between different providers. Above we have given how it would look like for locally ran node &amp; Maestro. Note that local node option still requires Maestro key for <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">lookupDatum</code> query.</li>
<li class="nx-my-2"><strong><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">networkId</code></strong>: Specifies your network and must be one of <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">mainnet</code>, <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">testnet-preprod</code>, <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">testnet-preview</code>, <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">testnet</code> (for legacy testnet) &amp; <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">privnet</code> (for local private network).</li>
<li class="nx-my-2"><strong><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">logging</code></strong>: It&#x27;s a list of <a href="https://hackage.haskell.org/package/katip-0.8.7.3/docs/Katip.html#t:Scribe" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">scribes<span class="nx-sr-only"> (opens in a new tab)</span></a> to register. Its parameters (like <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">severity</code>, <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">verbosity</code>) and its general usage can be understood by going over their official haddock documentation <a href="https://hackage.haskell.org/package/katip-0.8.7.2/docs/Katip.html" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">here<span class="nx-sr-only"> (opens in a new tab)</span></a>. Katip is also explained in <a href="https://link.springer.com/book/10.1007/978-1-4842-3739-7" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">this<span class="nx-sr-only"> (opens in a new tab)</span></a> book on web development in Haskell.</li>
<li class="nx-my-2"><strong><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">utxoCacheEnable</code></strong>: Enabling this boolean will enable cache (using <a href="https://hackage.haskell.org/package/cache-0.1.3.0/docs/Data-Cache.html" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">Data.Cache</code><span class="nx-sr-only"> (opens in a new tab)</span></a>) whereby queries related to fetching UTxOs won&#x27;t generate call to provider if the entry exists in cache (&amp; has not yet expired).</li>
</ul>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Parsing Given Configuration<span class="nx-absolute -nx-mt-20" id="parsing-given-configuration"></span><a href="#parsing-given-configuration" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">The file <a href="https://github.com/geniusyield/atlas-examples/tree/main/bet-ref/server/server-main.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">server-main.hs</code><span class="nx-sr-only"> (opens in a new tab)</span></a> fires up our server. It reads &amp; parses the configuration file and using it makes our endpoints (which we will define shortly) available. Here is its entire code.</p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-font-medium nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4 " data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10 [counter-reset:line] " dir="ltr" data-line-numbers="" data-language="haskell" data-theme="default" data-line-numbers-max-digits="2"><span class="line highlighted"><span style="color:var(--shiki-token-comment)">-- | Getting path for our core configuration.</span></span>
<span class="line highlighted"><span style="color:var(--shiki-token-function)">parseArgs</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">FilePath</span></span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">parseArgs </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">  args </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> getArgs</span></span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> args </span><span style="color:var(--shiki-token-keyword)">of</span></span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">    coreCfg</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> _ </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> return coreCfg</span></span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">    _invalidArgument </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> fail </span><span style="color:var(--shiki-token-string-expression)">&quot;Error: wrong arguments, needed a path to the CoreConfig JSON configuration file\n&quot;</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-function)">main</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">()</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">main </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  putStrLn </span><span style="color:var(--shiki-token-string-expression)">&quot;Writing Swagger file ...&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  BL8.writeFile </span><span style="color:var(--shiki-token-string-expression)">&quot;swagger-api.json&quot;</span><span style="color:var(--shiki-color-text)"> (encodePretty apiSwagger)</span></span>
<span class="line"> </span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">  putStrLn </span><span style="color:var(--shiki-token-string-expression)">&quot;parsing Config ...&quot;</span></span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">  coreCfgPath </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> parseArgs</span></span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">  coreCfg </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> coreConfigIO coreCfgPath  </span><span style="color:var(--shiki-token-comment)">-- Parsing our core configuration.</span></span>
<span class="line highlighted"> </span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">  putStrLn </span><span style="color:var(--shiki-token-string-expression)">&quot;Loading Providers ...&quot;</span></span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">  withCfgProviders coreCfg </span><span style="color:var(--shiki-token-string-expression)">&quot;api-server&quot;</span><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">\</span><span style="color:var(--shiki-color-text)">providers </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">let</span><span style="color:var(--shiki-color-text)"> port </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">8081</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        ctx </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> Ctx coreCfg providers</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    putStrLn </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;Starting server at \n &quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">&lt;&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;http://localhost:&quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">&lt;&gt;</span><span style="color:var(--shiki-color-text)"> show port</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    run port </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> app ctx</span></span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-function)">app</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Ctx</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Application</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">app ctx </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> cors (const </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> Just simpleCorsResourcePolicy { corsRequestHeaders </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> [HttpTypes.hContentType] }) </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> serve appApi </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> hoistServer appApi (Handler </span><span style="color:var(--shiki-token-keyword)">.</span><span style="color:var(--shiki-color-text)"> ExceptT </span><span style="color:var(--shiki-token-keyword)">.</span><span style="color:var(--shiki-color-text)"> try)  </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> apiServer ctx</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 " title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Focussing on the highlighted lines, you can see that it first reads the path to the configuration file (you would for instance run this file like so <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">cabal run betref-server -- config.json</code>) in line <span data-rehype-pretty-code-fragment=""><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-color-text)">coreCfgPath </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> parseArgs</span></span></code></span>, then it parses this file <span data-rehype-pretty-code-fragment=""><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-color-text)">coreCfg </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> coreConfigIO coreCfgPath</span></span></code></span>.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">We then see the use of an interesting function <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">withCfgProviders</code>. It&#x27;s type is <span data-rehype-pretty-code-fragment=""><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-token-function)">withCfgProviders</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYCoreConfig</span><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYLogNamespace</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">GYProviders</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span><span style="color:var(--shiki-color-text)"> a) </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span><span style="color:var(--shiki-color-text)"> a</span></span></code></span>, thus, this function first takes our parsed configuration file, then a namespace, finally followed by a continuation <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">GYProviders -&gt; IO a</code>. Idea here is that this function will setup a <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">GYProviders</code> from the parsed configuration file and send it to this continuation to obtain its result.</p>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">Defining Endpoints<span class="nx-absolute -nx-mt-20" id="defining-endpoints"></span><a href="#defining-endpoints" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Shared Context<span class="nx-absolute -nx-mt-20" id="shared-context"></span><a href="#shared-context" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<div class="nextra-callout nx-mt-6 nx-flex nx-rounded-lg nx-border nx-py-2 ltr:nx-pr-4 rtl:nx-pl-4 contrast-more:nx-border-current contrast-more:dark:nx-border-current nx-border-yellow-100 nx-bg-yellow-50 nx-text-yellow-900 dark:nx-border-yellow-200/30 dark:nx-bg-yellow-700/30 dark:nx-text-yellow-200"><div class="nx-select-none nx-text-xl ltr:nx-pl-3 ltr:nx-pr-2 rtl:nx-pr-3 rtl:nx-pl-2" style="font-family:&quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;">ðŸ“ƒ</div><div class="nx-w-full nx-min-w-0 nx-leading-7"><p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Entire code for it is available <a href="https://github.com/geniusyield/atlas-examples/tree/main/bet-ref/server-lib/BetRef/Api/Context.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">here<span class="nx-sr-only"> (opens in a new tab)</span></a></p></div></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Our endpoints would need an information for our provider, thus we have created the type for it, called <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">Ctx</code>. It&#x27;s usage is made clear by function defined next, <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">runQuery</code> which in essence correspond to <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">ctxRunC</code> we saw in section on <a class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]" href="/getting-started/integration-tests.mdx">Integration Tests</a>. Reasoning for <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">runTxI</code>, <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">runTxF</code> &amp; <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">runTxWithStrategyF</code> follows similarly.</p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-font-medium nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4 " data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">-- | Our Context.</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">data</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Ctx</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> Ctx</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  { ctxCoreCfg   </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYCoreConfig</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , ctxProviders </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYProviders</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | To run for simple queries, the one which don&#x27;t requiring building for transaction skeleton.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">runQuery</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Ctx</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxQueryMonadNode</span><span style="color:var(--shiki-color-text)"> a </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span><span style="color:var(--shiki-color-text)"> a</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">runQuery ctx q </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">let</span><span style="color:var(--shiki-color-text)"> nid       </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> cfgNetworkId </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> ctxCoreCfg ctx</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      providers </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> ctxProviders ctx</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  runGYTxQueryMonadNode nid providers q</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Wraps our skeleton under `Identity` and calls `runTxF`.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">runTxI</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Ctx</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">       </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> [</span><span style="color:var(--shiki-token-keyword)">GYAddress</span><span style="color:var(--shiki-color-text)">]     </span><span style="color:var(--shiki-token-comment)">-- ^ user&#x27;s used addresses</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">       </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYAddress</span><span style="color:var(--shiki-color-text)">       </span><span style="color:var(--shiki-token-comment)">-- ^ user&#x27;s change address</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">       </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxOutRefCbor</span><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-comment)">-- ^ user&#x27;s collateral</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">       </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxMonadNode</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">GYTxSkeleton</span><span style="color:var(--shiki-color-text)"> v)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">       </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxBody</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">runTxI </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> coerce (runTxF </span><span style="color:var(--shiki-token-keyword)">@Identity</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Tries to build for given skeletons wrapped under traversable structure.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">runTxF</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Traversable</span><span style="color:var(--shiki-color-text)"> t</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">       </span><span style="color:var(--shiki-token-keyword)">=&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Ctx</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">       </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> [</span><span style="color:var(--shiki-token-keyword)">GYAddress</span><span style="color:var(--shiki-color-text)">]     </span><span style="color:var(--shiki-token-comment)">-- ^ user&#x27;s used addresses</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">       </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYAddress</span><span style="color:var(--shiki-color-text)">       </span><span style="color:var(--shiki-token-comment)">-- ^ user&#x27;s change address</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">       </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxOutRefCbor</span><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-comment)">-- ^ user&#x27;s collateral</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">       </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxMonadNode</span><span style="color:var(--shiki-color-text)"> (t (</span><span style="color:var(--shiki-token-keyword)">GYTxSkeleton</span><span style="color:var(--shiki-color-text)"> v))</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">       </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span><span style="color:var(--shiki-color-text)"> (t </span><span style="color:var(--shiki-token-keyword)">GYTxBody</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">runTxF </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> runTxWithStrategyF GYRandomImproveMultiAsset</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Create &#x27;TxBody&#x27; from a &#x27;GYTxSkeleton&#x27;, with the specified coin selection strategy.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">runTxWithStrategyF</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Traversable</span><span style="color:var(--shiki-color-text)"> t</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                   </span><span style="color:var(--shiki-token-keyword)">=&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYCoinSelectionStrategy</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                   </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Ctx</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                   </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> [</span><span style="color:var(--shiki-token-keyword)">GYAddress</span><span style="color:var(--shiki-color-text)">]</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                   </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYAddress</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                   </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxOutRefCbor</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                   </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxMonadNode</span><span style="color:var(--shiki-color-text)"> (t (</span><span style="color:var(--shiki-token-keyword)">GYTxSkeleton</span><span style="color:var(--shiki-color-text)"> v))</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                   </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span><span style="color:var(--shiki-color-text)"> (t </span><span style="color:var(--shiki-token-keyword)">GYTxBody</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">runTxWithStrategyF cstrat ctx addrs addr collateral skeleton  </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">let</span><span style="color:var(--shiki-color-text)"> nid       </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> cfgNetworkId </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> ctxCoreCfg ctx</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      providers </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> ctxProviders ctx</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  runGYTxMonadNodeF cstrat nid providers addrs addr (getTxOutRefHex collateral) skeleton</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 " title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">Submit Endpoint<span class="nx-absolute -nx-mt-20" id="submit-endpoint"></span><a href="#submit-endpoint" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<div class="nextra-callout nx-mt-6 nx-flex nx-rounded-lg nx-border nx-py-2 ltr:nx-pr-4 rtl:nx-pl-4 contrast-more:nx-border-current contrast-more:dark:nx-border-current nx-border-yellow-100 nx-bg-yellow-50 nx-text-yellow-900 dark:nx-border-yellow-200/30 dark:nx-bg-yellow-700/30 dark:nx-text-yellow-200"><div class="nx-select-none nx-text-xl ltr:nx-pl-3 ltr:nx-pr-2 rtl:nx-pr-3 rtl:nx-pl-2" style="font-family:&quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;">ðŸ“ƒ</div><div class="nx-w-full nx-min-w-0 nx-leading-7"><p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Entire code for it is available <a href="https://github.com/geniusyield/atlas-examples/tree/main/bet-ref/server-lib/BetRef/Api/Tx.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">here<span class="nx-sr-only"> (opens in a new tab)</span></a></p></div></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">We&#x27;ll soon see endpoints which will return for unsigned transaction to the browser but assuming that we already have a signed transaction CBOR, let&#x27;s see how we can define an endpoint to submit it using our provider.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Focussing at <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">handleSubmitTx</code> function, we see that we first parse the obtained CBOR text in our <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">GYTx</code> type, then we simply call the submit operation for our providor. Then we send back the response letting our front-end know about the transaction fees (which though it would already know when having performed the signing operation, but other fields could also be added here depending upon use case) and the transactoin id.</p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-font-medium nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4 " data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">-- | Return type of API when submitting a transaction.</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">data</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">SubmitTxResponse</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> SubmitTxResponse</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                          { submitTxFee </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!Integer</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                          , submitTxId  </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYTxId</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                          } </span><span style="color:var(--shiki-token-keyword)">deriving</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">Show</span><span style="color:var(--shiki-color-text)">, </span><span style="color:var(--shiki-token-keyword)">Generic</span><span style="color:var(--shiki-color-text)">, </span><span style="color:var(--shiki-token-keyword)">ToJSON</span><span style="color:var(--shiki-color-text)">, Swagger.</span><span style="color:var(--shiki-token-keyword)">ToSchema</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Construct `SubmitTxResponse` return type from the given signed transaction body.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">txBodySubmitTxResponse</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxBody</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">SubmitTxResponse</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">txBodySubmitTxResponse txBody </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> SubmitTxResponse</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                                  { submitTxFee </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> txBodyFee txBody</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                                  , submitTxId  </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> txBodyTxId txBody</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                                  }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Type for our Servant API.</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">type</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">TxAPI</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-string-expression)">&quot;submit&quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">:&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">ReqBody</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">&#x27;</span><span style="color:var(--shiki-color-text)">[</span><span style="color:var(--shiki-token-keyword)">JSON</span><span style="color:var(--shiki-color-text)">] </span><span style="color:var(--shiki-token-keyword)">GYTx</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">:&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Post</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">&#x27;</span><span style="color:var(--shiki-color-text)">[</span><span style="color:var(--shiki-token-keyword)">JSON</span><span style="color:var(--shiki-color-text)">] </span><span style="color:var(--shiki-token-keyword)">SubmitTxResponse</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Serving our API.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">handleTx</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Ctx</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">ServerT</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">TxAPI</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">handleTx </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> handleSubmitTx</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Handle for submit operation.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">handleSubmitTx</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Ctx</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTx</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">SubmitTxResponse</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">handleSubmitTx ctx tx </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    void (gySubmitTx (ctxProviders ctx) tx)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    return </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> txBodySubmitTxResponse (getTxBody tx)</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 " title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Transaction Building Endpoints<span class="nx-absolute -nx-mt-20" id="transaction-building-endpoints"></span><a href="#transaction-building-endpoints" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<div class="nextra-callout nx-mt-6 nx-flex nx-rounded-lg nx-border nx-py-2 ltr:nx-pr-4 rtl:nx-pl-4 contrast-more:nx-border-current contrast-more:dark:nx-border-current nx-border-yellow-100 nx-bg-yellow-50 nx-text-yellow-900 dark:nx-border-yellow-200/30 dark:nx-bg-yellow-700/30 dark:nx-text-yellow-200"><div class="nx-select-none nx-text-xl ltr:nx-pl-3 ltr:nx-pr-2 rtl:nx-pr-3 rtl:nx-pl-2" style="font-family:&quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;">ðŸ“ƒ</div><div class="nx-w-full nx-min-w-0 nx-leading-7"><p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Entire code for it is available <a href="https://github.com/geniusyield/atlas-examples/tree/main/bet-ref/server-lib/BetRef/Api/BetRef.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">here<span class="nx-sr-only"> (opens in a new tab)</span></a></p></div></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">At this point, it should be easy to follow the code here. We first define the input type for our endpoint, we also derive its <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">FromJSON</code> instance so that we can parse it from JSON that our front-end will send for it and we also derive its <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">Swagger.ToSchema</code> instance so as to document our endpoint. Then our endpoint calls the relevant operation which we defined before to get transactoin skeleton, using which we obtain the transaction body with the help of functions such as <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">runTxI</code> and return the result (wrapped in our <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">UnsignedTxResponse</code> type).</p>
<div class="nextra-callout nx-mt-6 nx-flex nx-rounded-lg nx-border nx-py-2 ltr:nx-pr-4 rtl:nx-pl-4 contrast-more:nx-border-current contrast-more:dark:nx-border-current nx-border-orange-100 nx-bg-orange-50 nx-text-orange-800 dark:nx-border-orange-400/30 dark:nx-bg-orange-400/20 dark:nx-text-orange-300"><div class="nx-select-none nx-text-xl ltr:nx-pl-3 ltr:nx-pr-2 rtl:nx-pr-3 rtl:nx-pl-2" style="font-family:&quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;">ðŸ’¡</div><div class="nx-w-full nx-min-w-0 nx-leading-7"><p class="nx-mt-6 nx-leading-7 first:nx-mt-0">You can see that all of our endpoints here ask for a list of used addresses, this makes them compatible with wallets that are not in single address mode (by default) such as <a href="https://eternl.io/" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">Eternl<span class="nx-sr-only"> (opens in a new tab)</span></a>.</p></div></div>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-font-medium nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4 " data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">-- | Input wrapper around corresponding Plutus type.</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">data</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">BetRefParams</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> BetRefParams</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  { brpOracleAddress </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYAddress</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , brpBetUntil      </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYTime</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , brpBetReveal     </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYTime</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , brpBetStep       </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYValue</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  } </span><span style="color:var(--shiki-token-keyword)">deriving</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">Show</span><span style="color:var(--shiki-color-text)">, </span><span style="color:var(--shiki-token-keyword)">Generic</span><span style="color:var(--shiki-color-text)">, </span><span style="color:var(--shiki-token-keyword)">FromJSON</span><span style="color:var(--shiki-color-text)">, Swagger.</span><span style="color:var(--shiki-token-keyword)">ToSchema</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Convert the above `BetRefParams` with corresponding representation defined in our Plutus validator script.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">betParamsToScript</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">BetRefParams</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> Script.</span><span style="color:var(--shiki-token-keyword)">BetRefParams</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">betParamsToScript brp </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> Script.BetRefParams</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  { Script.brpOraclePkh </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> pubKeyHashToPlutus </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> fromJust </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> addressToPubKeyHash </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> brpOracleAddress brp</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , Script.brpBetUntil </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> timeToPlutus </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)">  brpBetUntil brp</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , Script.brpBetReveal </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> timeToPlutus </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> brpBetReveal brp</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , Script.brpBetStep </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> valueToPlutus </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)">  brpBetStep brp</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Input parameters for place bet operation.</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">data</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">PlaceBetRefParams</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> PlaceBetRefParams</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  { pbrUsedAddrs  </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-color-text)">[</span><span style="color:var(--shiki-token-keyword)">GYAddress</span><span style="color:var(--shiki-color-text)">]</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , pbrChangeAddr </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYAddress</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , pbrCollateral </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYTxOutRefCbor</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , pbrBetParams  </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!BetRefParams</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , pbrBetGuess   </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!Integer</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , pbrBetAmt     </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYValue</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , pbrRefScript  </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYTxOutRef</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , pbrPrevBetRef </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">Maybe</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxOutRef</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  } </span><span style="color:var(--shiki-token-keyword)">deriving</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">Show</span><span style="color:var(--shiki-color-text)">, </span><span style="color:var(--shiki-token-keyword)">Generic</span><span style="color:var(--shiki-color-text)">, </span><span style="color:var(--shiki-token-keyword)">FromJSON</span><span style="color:var(--shiki-color-text)">, Swagger.</span><span style="color:var(--shiki-token-keyword)">ToSchema</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Input parameters for take bets operation.</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">data</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">TakeBetRefParams</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> TakeBetRefParams</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  { tbrUsedAddrs         </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-color-text)">[</span><span style="color:var(--shiki-token-keyword)">GYAddress</span><span style="color:var(--shiki-color-text)">]</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , tbrChangeAddr        </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYAddress</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , tbrCollateral        </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYTxOutRefCbor</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , tbrBetParams         </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!BetRefParams</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , tbrRefScript         </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYTxOutRef</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , tbrPrevBetRef        </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYTxOutRef</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , tbrOracleRefInputRef </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYTxOutRef</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  } </span><span style="color:var(--shiki-token-keyword)">deriving</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">Show</span><span style="color:var(--shiki-color-text)">, </span><span style="color:var(--shiki-token-keyword)">Generic</span><span style="color:var(--shiki-color-text)">, </span><span style="color:var(--shiki-token-keyword)">FromJSON</span><span style="color:var(--shiki-color-text)">, Swagger.</span><span style="color:var(--shiki-token-keyword)">ToSchema</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Input parameters to add for reference script.</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">data</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">AddRefScriptParams</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> AddRefScriptParams</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  { arsUsedAddrs  </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-color-text)">[</span><span style="color:var(--shiki-token-keyword)">GYAddress</span><span style="color:var(--shiki-color-text)">]</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , arsChangeAddr </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYAddress</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , arsCollateral </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYTxOutRefCbor</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , arsPutAddress </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYAddress</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , arsBetParams  </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!BetRefParams</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  } </span><span style="color:var(--shiki-token-keyword)">deriving</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">Show</span><span style="color:var(--shiki-color-text)">, </span><span style="color:var(--shiki-token-keyword)">Generic</span><span style="color:var(--shiki-color-text)">, </span><span style="color:var(--shiki-token-keyword)">FromJSON</span><span style="color:var(--shiki-color-text)">, Swagger.</span><span style="color:var(--shiki-token-keyword)">ToSchema</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Input parameters to add for reference input.</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">data</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">AddRefInputParams</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> AddRefInputParams</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  { ariUsedAddrs  </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-color-text)">[</span><span style="color:var(--shiki-token-keyword)">GYAddress</span><span style="color:var(--shiki-color-text)">]</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , ariChangeAddr </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYAddress</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , ariCollateral </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYTxOutRefCbor</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , ariPutAddress </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!GYAddress</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , ariBetAnswer  </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!Integer</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  } </span><span style="color:var(--shiki-token-keyword)">deriving</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">Show</span><span style="color:var(--shiki-color-text)">, </span><span style="color:var(--shiki-token-keyword)">Generic</span><span style="color:var(--shiki-color-text)">, </span><span style="color:var(--shiki-token-keyword)">FromJSON</span><span style="color:var(--shiki-color-text)">, Swagger.</span><span style="color:var(--shiki-token-keyword)">ToSchema</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Return type for our API endpoints defined here.</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">data</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">UnsignedTxResponse</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> UnsignedTxResponse</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  { urspTxBodyHex  </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-color-text)">T.</span><span style="color:var(--shiki-token-keyword)">Text</span><span style="color:var(--shiki-color-text)">           </span><span style="color:var(--shiki-token-comment)">-- ^ Unsigned transaction cbor.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , urspTxFee      </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">Maybe</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Integer</span><span style="color:var(--shiki-color-text)">)  </span><span style="color:var(--shiki-token-comment)">-- ^ Tx fees.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , urspUtxoRefIdx </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">Maybe</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Word</span><span style="color:var(--shiki-color-text)">)     </span><span style="color:var(--shiki-token-comment)">-- ^ Some operations might need to show for relevant UTxO generated, this index will let UI know of it. Note that Transaction ID would change after getting signed.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  } </span><span style="color:var(--shiki-token-keyword)">deriving</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">Show</span><span style="color:var(--shiki-color-text)">, </span><span style="color:var(--shiki-token-keyword)">Generic</span><span style="color:var(--shiki-color-text)">, </span><span style="color:var(--shiki-token-keyword)">FromJSON</span><span style="color:var(--shiki-color-text)">, </span><span style="color:var(--shiki-token-keyword)">ToJSON</span><span style="color:var(--shiki-color-text)">, Swagger.</span><span style="color:var(--shiki-token-keyword)">ToSchema</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Construct `UnsignedTxResponse` return type for our endpoint given the transaction body &amp; relevant index for UTxO (if such exists).</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">unSignedTxWithFee</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxBody</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Maybe</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Word</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">UnsignedTxResponse</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">unSignedTxWithFee txBody mUtxoRefIdx </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> UnsignedTxResponse</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  { urspTxBodyHex  </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> T.pack </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> txToHex </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> unsignedTx txBody</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , urspTxFee      </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> Just </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> txBodyFee txBody</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  , urspUtxoRefIdx </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> mUtxoRefIdx</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Type for our Servant API.</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">type</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">BetRefApi</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">       </span><span style="color:var(--shiki-token-string-expression)">&quot;place&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">:&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">ReqBody</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">&#x27;</span><span style="color:var(--shiki-color-text)">[</span><span style="color:var(--shiki-token-keyword)">JSON</span><span style="color:var(--shiki-color-text)">] </span><span style="color:var(--shiki-token-keyword)">PlaceBetRefParams</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">:&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Post</span><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">&#x27;</span><span style="color:var(--shiki-color-text)">[</span><span style="color:var(--shiki-token-keyword)">JSON</span><span style="color:var(--shiki-color-text)">] </span><span style="color:var(--shiki-token-keyword)">UnsignedTxResponse</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">:&lt;|&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;take&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">:&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">ReqBody</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">&#x27;</span><span style="color:var(--shiki-color-text)">[</span><span style="color:var(--shiki-token-keyword)">JSON</span><span style="color:var(--shiki-color-text)">] </span><span style="color:var(--shiki-token-keyword)">TakeBetRefParams</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">:&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Post</span><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">&#x27;</span><span style="color:var(--shiki-color-text)">[</span><span style="color:var(--shiki-token-keyword)">JSON</span><span style="color:var(--shiki-color-text)">] </span><span style="color:var(--shiki-token-keyword)">UnsignedTxResponse</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">:&lt;|&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;add-ref-script&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">:&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">ReqBody</span><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">&#x27;</span><span style="color:var(--shiki-color-text)">[</span><span style="color:var(--shiki-token-keyword)">JSON</span><span style="color:var(--shiki-color-text)">] </span><span style="color:var(--shiki-token-keyword)">AddRefScriptParams</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">:&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Post</span><span style="color:var(--shiki-color-text)">     </span><span style="color:var(--shiki-token-keyword)">&#x27;</span><span style="color:var(--shiki-color-text)">[</span><span style="color:var(--shiki-token-keyword)">JSON</span><span style="color:var(--shiki-color-text)">] </span><span style="color:var(--shiki-token-keyword)">UnsignedTxResponse</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">:&lt;|&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;add-ref-input&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">:&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">ReqBody</span><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">&#x27;</span><span style="color:var(--shiki-color-text)">[</span><span style="color:var(--shiki-token-keyword)">JSON</span><span style="color:var(--shiki-color-text)">] </span><span style="color:var(--shiki-token-keyword)">AddRefInputParams</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">:&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Post</span><span style="color:var(--shiki-color-text)">     </span><span style="color:var(--shiki-token-keyword)">&#x27;</span><span style="color:var(--shiki-color-text)">[</span><span style="color:var(--shiki-token-keyword)">JSON</span><span style="color:var(--shiki-color-text)">] </span><span style="color:var(--shiki-token-keyword)">UnsignedTxResponse</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Serving our API.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">handleBetRefApi</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Ctx</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">ServerT</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">BetRefApi</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">handleBetRefApi ctx </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)">   handlePlaceBet ctx</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                   </span><span style="color:var(--shiki-token-keyword)">:&lt;|&gt;</span><span style="color:var(--shiki-color-text)"> handleTakeBet ctx</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                   </span><span style="color:var(--shiki-token-keyword)">:&lt;|&gt;</span><span style="color:var(--shiki-color-text)"> handleAddRefScript ctx</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                   </span><span style="color:var(--shiki-token-keyword)">:&lt;|&gt;</span><span style="color:var(--shiki-color-text)"> handleOracleRefInput ctx</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Handle for place bet operation.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">handlePlaceBet</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Ctx</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">PlaceBetRefParams</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">UnsignedTxResponse</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">handlePlaceBet ctx PlaceBetRefParams{..} </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">let</span><span style="color:var(--shiki-color-text)"> brp </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> betParamsToScript pbrBetParams</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  validatorAddress </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> runQuery ctx (betRefAddress brp)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  txBody </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> runTxI ctx pbrUsedAddrs pbrChangeAddr pbrCollateral</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> placeBet pbrRefScript (betParamsToScript pbrBetParams) (Script.OracleAnswerDatum pbrBetGuess) pbrBetAmt (head pbrUsedAddrs) pbrPrevBetRef</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  placeUtxoRef </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> find (</span><span style="color:var(--shiki-token-keyword)">\</span><span style="color:var(--shiki-color-text)">utxo </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> utxoAddress utxo </span><span style="color:var(--shiki-token-keyword)">==</span><span style="color:var(--shiki-color-text)"> validatorAddress) </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> utxosToList </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> txBodyUTxOs txBody </span><span style="color:var(--shiki-token-keyword)">of</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        Nothing </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> fail </span><span style="color:var(--shiki-token-string-expression)">&quot;Shouldn&#x27;t happen: No reference for placed bet in body&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        Just utxo </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> pure </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> utxoRef utxo</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  pure </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> unSignedTxWithFee txBody (Just </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> snd </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> txOutRefToTuple placeUtxoRef)</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Handle for take bets operation.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">handleTakeBet</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Ctx</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">TakeBetRefParams</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">UnsignedTxResponse</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">handleTakeBet ctx TakeBetRefParams{..} </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  txBody </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> runTxI ctx tbrUsedAddrs tbrChangeAddr tbrCollateral</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> takeBets tbrRefScript (betParamsToScript tbrBetParams) tbrPrevBetRef (head tbrUsedAddrs) tbrOracleRefInputRef</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  pure </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> unSignedTxWithFee txBody Nothing</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Handle for adding reference script.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">handleAddRefScript</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Ctx</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">AddRefScriptParams</span><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">UnsignedTxResponse</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">handleAddRefScript  ctx AddRefScriptParams{..} </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">let</span><span style="color:var(--shiki-color-text)"> validator </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> betRefValidator&#x27; (betParamsToScript arsBetParams)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  txBody </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> runTxI ctx arsUsedAddrs arsChangeAddr arsCollateral</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> pure </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> addRefScript&#x27; arsPutAddress validator</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">let</span><span style="color:var(--shiki-color-text)"> refs   </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> Limbo.findRefScriptsInBody txBody</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  outRef </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> Map.lookup (Some (validatorToScript validator)) refs </span><span style="color:var(--shiki-token-keyword)">of</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                 Nothing  </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> fail </span><span style="color:var(--shiki-token-string-expression)">&quot;Shouldn&#x27;t happen: No reference for added Script in body&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                 Just ref </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> return ref</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  pure </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> unSignedTxWithFee txBody (Just </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> snd </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> txOutRefToTuple outRef)</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Handle for adding reference input.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">handleOracleRefInput</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Ctx</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">AddRefInputParams</span><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">UnsignedTxResponse</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">handleOracleRefInput  ctx AddRefInputParams{..} </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">let</span><span style="color:var(--shiki-color-text)"> ourDatumPlutus </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> Script.OracleAnswerDatum ariBetAnswer</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      ourDatumGY </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> datumFromPlutusData ourDatumPlutus</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  txBody </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> runTxI ctx ariUsedAddrs ariChangeAddr ariCollateral</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> pure </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> addRefInput&#x27; ariPutAddress ourDatumPlutus</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">let</span><span style="color:var(--shiki-color-text)"> utxos </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> utxosToList </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> txBodyUTxOs txBody</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      ourDatumHash </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> hashDatum ourDatumGY</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      mRefInputUtxo </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> find (</span><span style="color:var(--shiki-token-keyword)">\</span><span style="color:var(--shiki-color-text)">utxo </span><span style="color:var(--shiki-token-keyword)">-&gt;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> utxoOutDatum utxo </span><span style="color:var(--shiki-token-keyword)">of</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">          GYOutDatumHash dh  </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> ourDatumHash </span><span style="color:var(--shiki-token-keyword)">==</span><span style="color:var(--shiki-color-text)"> dh</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">          GYOutDatumInline d </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> ourDatumGY </span><span style="color:var(--shiki-token-keyword)">==</span><span style="color:var(--shiki-color-text)"> d</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">          GYOutDatumNone     </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> False</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        ) utxos</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> mRefInputUtxo </span><span style="color:var(--shiki-token-keyword)">of</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    Nothing               </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> fail </span><span style="color:var(--shiki-token-string-expression)">&quot;Shouldn&#x27;t happen: Couldn&#x27;t find the desired UTxO in Tx outputs&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    Just GYUTxO {utxoRef} </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> pure </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> unSignedTxWithFee txBody (Just </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> snd </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> txOutRefToTuple utxoRef)</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 " title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Wrap-Up<span class="nx-absolute -nx-mt-20" id="wrap-up"></span><a href="#wrap-up" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Our both the endpoints file (transaction submition &amp; transaction building) our wrapped up in our <a href="https://github.com/geniusyield/atlas-examples/tree/main/bet-ref/server-lib/BetRef/Api/Api.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">Api.hs</code><span class="nx-sr-only"> (opens in a new tab)</span></a> following the usual servant boilerplate.</p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-font-medium nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4 " data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">-- | Type for our Servant API.</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">type</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Api</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-string-expression)">&quot;tx&quot;</span><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">:&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">TxAPI</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">:&lt;|&gt;</span><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-string-expression)">&quot;betref&quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">:&gt;</span><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">BetRefApi</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-function)">appApi</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Proxy</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Api</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">appApi </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> Proxy</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-function)">apiSwagger</span><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Swagger</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">apiSwagger  </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> toSwagger appApi</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-function)">apiServer</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Ctx</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">ServerT</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Api</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">apiServer ctx </span><span style="color:var(--shiki-token-keyword)">=</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">       handleTx ctx</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">:&lt;|&gt;</span><span style="color:var(--shiki-color-text)"> handleBetRefApi ctx</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 " title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Now coming back to our <a href="https://github.com/geniusyield/atlas-examples/tree/main/bet-ref/server/server-main.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">server-main.hs</code><span class="nx-sr-only"> (opens in a new tab)</span></a> file, we can now understand the highlighted code sections which relates to obtaining the Swagger file (generated from <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">apiSwagger</code> function above) and running up our servant server.</p>
<div class="nextra-callout nx-mt-6 nx-flex nx-rounded-lg nx-border nx-py-2 ltr:nx-pr-4 rtl:nx-pl-4 contrast-more:nx-border-current contrast-more:dark:nx-border-current nx-border-orange-100 nx-bg-orange-50 nx-text-orange-800 dark:nx-border-orange-400/30 dark:nx-bg-orange-400/20 dark:nx-text-orange-300"><div class="nx-select-none nx-text-xl ltr:nx-pl-3 ltr:nx-pr-2 rtl:nx-pr-3 rtl:nx-pl-2" style="font-family:&quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;">ðŸ’¡</div><div class="nx-w-full nx-min-w-0 nx-leading-7"><p class="nx-mt-6 nx-leading-7 first:nx-mt-0">We follow <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">simpleCorsResourcePolicy</code> (also allowing <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10  " dir="ltr">Content-Type</code> request header) so that calls by our front-end (which runs on different origin) don&#x27;t get blocked.</p></div></div>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-font-medium nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4 " data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10 [counter-reset:line] " dir="ltr" data-line-numbers="" data-language="haskell" data-theme="default" data-line-numbers-max-digits="2"><span class="line"><span style="color:var(--shiki-token-comment)">-- | Getting path for our core configuration.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">parseArgs</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">FilePath</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">parseArgs </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  args </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> getArgs</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> args </span><span style="color:var(--shiki-token-keyword)">of</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    coreCfg</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> _ </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> return coreCfg</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    _invalidArgument </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> fail </span><span style="color:var(--shiki-token-string-expression)">&quot;Error: wrong arguments, needed a path to the CoreConfig JSON configuration file\n&quot;</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-function)">main</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IO</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">()</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">main </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">  putStrLn </span><span style="color:var(--shiki-token-string-expression)">&quot;Writing Swagger file ...&quot;</span></span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">  BL8.writeFile </span><span style="color:var(--shiki-token-string-expression)">&quot;swagger-api.json&quot;</span><span style="color:var(--shiki-color-text)"> (encodePretty apiSwagger)</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">  putStrLn </span><span style="color:var(--shiki-token-string-expression)">&quot;parsing Config ...&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  coreCfgPath </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> parseArgs</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  coreCfg </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> coreConfigIO coreCfgPath  </span><span style="color:var(--shiki-token-comment)">-- Parsing our core configuration.</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">  putStrLn </span><span style="color:var(--shiki-token-string-expression)">&quot;Loading Providers ...&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  withCfgProviders coreCfg </span><span style="color:var(--shiki-token-string-expression)">&quot;api-server&quot;</span><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">\</span><span style="color:var(--shiki-color-text)">providers </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">let</span><span style="color:var(--shiki-color-text)"> port </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">8081</span></span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">        ctx </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> Ctx coreCfg providers</span></span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">    putStrLn </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;Starting server at \n &quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">&lt;&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;http://localhost:&quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">&lt;&gt;</span><span style="color:var(--shiki-color-text)"> show port</span></span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">    run port </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> app ctx</span></span>
<span class="line highlighted"> </span>
<span class="line highlighted"> </span>
<span class="line highlighted"><span style="color:var(--shiki-token-function)">app</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Ctx</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Application</span></span>
<span class="line highlighted"><span style="color:var(--shiki-color-text)">app ctx </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> cors (const </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> Just simpleCorsResourcePolicy { corsRequestHeaders </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> [HttpTypes.hContentType] }) </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> serve appApi </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> hoistServer appApi (Handler </span><span style="color:var(--shiki-token-keyword)">.</span><span style="color:var(--shiki-color-text)"> ExceptT </span><span style="color:var(--shiki-token-keyword)">.</span><span style="color:var(--shiki-color-text)"> try)  </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> apiServer ctx</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 " title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Next we&#x27;ll see how to call these endpoints in our front-end!</p><div class="nx-mt-16"></div><div class="nx-mb-8 nx-flex nx-items-center nx-border-t nx-pt-8 dark:nx-border-neutral-800 contrast-more:nx-border-neutral-400 dark:contrast-more:nx-border-neutral-400"><a title="Integration Tests" class="nx-flex nx-max-w-[50%] nx-items-center nx-gap-1 nx-py-4 nx-text-base nx-font-medium nx-text-gray-600 nx-transition-colors [word-break:break-word] hover:nx-text-primary-600 dark:nx-text-gray-300 md:nx-text-lg ltr:nx-pr-4 rtl:nx-pl-4" href="/getting-started/integration-tests"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-inline nx-h-5 nx-shrink-0 ltr:nx-rotate-180"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>Integration Tests</a><a title="Browser Integration" class="nx-flex nx-max-w-[50%] nx-items-center nx-gap-1 nx-py-4 nx-text-base nx-font-medium nx-text-gray-600 nx-transition-colors [word-break:break-word] hover:nx-text-primary-600 dark:nx-text-gray-300 md:nx-text-lg ltr:nx-ml-auto ltr:nx-pl-4 ltr:nx-text-right rtl:nx-mr-auto rtl:nx-pr-4 rtl:nx-text-left" href="/getting-started/browser-integration">Browser Integration<svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-inline nx-h-5 nx-shrink-0 rtl:nx-rotate-180"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></a></div></main></article></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/getting-started/endpoints","query":{},"buildId":"ux_KgcFslnSxR-Abq8Hmw","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>