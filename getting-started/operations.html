<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Atlas | Operations over Contract</title><meta name="robots" content="index,follow"/><meta name="description" content="All-in-one solution for writing off-chain code for Plutus contracts"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://www.geniusyield.co"/><meta name="twitter:creator" content="@GeniusyieldO"/><meta property="og:title" content="Atlas | Operations over Contract"/><meta property="og:description" content="All-in-one solution for writing off-chain code for Plutus contracts"/><meta property="og:url" content="https://atlas-app.io"/><meta property="og:image" content="/open-graph.png"/><meta property="og:image:alt" content="Atlas - Application backend for Plutus smart contracts on Cardano"/><meta property="og:image:type" content="image/png"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><link rel="canonical" href="https://atlas-app.io"/><meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/><style>
        :root {
          --nextra-primary-hue: 212deg;
          --nextra-primary-saturation: 100%;
          --nextra-navbar-height: 4rem;
          --nextra-menu-height: 3.75rem;
          --nextra-banner-height: 2.5rem;
        }
        
        .dark {
          --nextra-primary-hue: 204deg;
          --nextra-primary-saturation: 100%;
        }
      </style><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#da532c"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#ffffff"/><meta name="next-head-count" content="27"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/2e27e0463af74fb7.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/2e27e0463af74fb7.css" crossorigin="" data-n-g=""/><link rel="preload" href="/_next/static/css/445c4173ffc2bf04.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/445c4173ffc2bf04.css" crossorigin="" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-6af0e3c12b874bb0.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-0c7baedefba6b077.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-97ba2b627474e8da.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-0d8f17958d233d59.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/600-f39f017bd81d0f69.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/getting-started/operations-5f45c999c794931e.js" defer="" crossorigin=""></script><script src="/_next/static/VLgWUhfJ0Kas4LO5gRIIf/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/VLgWUhfJ0Kas4LO5gRIIf/_ssgManifest.js" defer="" crossorigin=""></script></head><body><div id="__next"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&false)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}else{c.add('dark')}if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'dark'}catch(e){}}()</script><div dir="ltr"><script>document.documentElement.setAttribute('dir','ltr')</script><div class="nextra-nav-container nx-sticky nx-top-0 nx-z-20 nx-w-full nx-bg-transparent print:nx-hidden"><div class="nextra-nav-container-blur nx-pointer-events-none nx-absolute nx-z-[-1] nx-h-full nx-w-full nx-bg-white dark:nx-bg-dark nx-shadow-[0_2px_4px_rgba(0,0,0,.02),0_1px_0_rgba(0,0,0,.06)] dark:nx-shadow-[0_-1px_0_rgba(255,255,255,.1)_inset] contrast-more:nx-shadow-[0_0_0_1px_#000] contrast-more:dark:nx-shadow-[0_0_0_1px_#fff]"></div><nav class="nx-mx-auto nx-flex nx-h-[var(--nextra-navbar-height)] nx-max-w-[90rem] nx-items-center nx-justify-end nx-gap-2 nx-pl-[max(env(safe-area-inset-left),1.5rem)] nx-pr-[max(env(safe-area-inset-right),1.5rem)]"><a class="nx-flex nx-items-center hover:nx-opacity-75 ltr:nx-mr-auto rtl:nx-ml-auto" href="/"><img alt="Atlas Logo" loading="lazy" width="124" height="42" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/atlas-logo-dark-mode.62b4f6dd.svg"/></a><a class="nx-text-sm contrast-more:nx-text-gray-700 contrast-more:dark:nx-text-gray-100 nx-relative -nx-ml-2 nx-hidden nx-whitespace-nowrap nx-p-2 md:nx-inline-block nx-font-medium nx-subpixel-antialiased" aria-current="true" href="/introduction"><span class="nx-absolute nx-inset-x-0 nx-text-center">Documentation</span><span class="nx-invisible nx-font-medium">Documentation</span></a><div class="nextra-search nx-relative md:nx-w-64 nx-hidden md:nx-inline-block mx-min-w-[200px]"><div class="nx-relative nx-flex nx-items-center nx-text-gray-900 contrast-more:nx-text-gray-800 dark:nx-text-gray-300 contrast-more:dark:nx-text-gray-300"><input spellcheck="false" class="nx-block nx-w-full nx-appearance-none nx-rounded-lg nx-px-3 nx-py-2 nx-transition-colors nx-text-base nx-leading-tight md:nx-text-sm nx-bg-black/[.05] dark:nx-bg-gray-50/10 focus:nx-bg-white dark:focus:nx-bg-dark placeholder:nx-text-gray-500 dark:placeholder:nx-text-gray-400 contrast-more:nx-border contrast-more:nx-border-current" type="search" placeholder="Search documentation…" value=""/></div></div><a href="https://github.com/geniusyield/atlas" target="_blank" rel="noreferrer" class="nx-p-2 nx-text-current"><svg width="24" height="24" fill="currentColor" viewBox="3 3 18 18"><title>GitHub</title><path d="M12 3C7.0275 3 3 7.12937 3 12.2276C3 16.3109 5.57625 19.7597 9.15374 20.9824C9.60374 21.0631 9.77249 20.7863 9.77249 20.5441C9.77249 20.3249 9.76125 19.5982 9.76125 18.8254C7.5 19.2522 6.915 18.2602 6.735 17.7412C6.63375 17.4759 6.19499 16.6569 5.8125 16.4378C5.4975 16.2647 5.0475 15.838 5.80124 15.8264C6.51 15.8149 7.01625 16.4954 7.18499 16.7723C7.99499 18.1679 9.28875 17.7758 9.80625 17.5335C9.885 16.9337 10.1212 16.53 10.38 16.2993C8.3775 16.0687 6.285 15.2728 6.285 11.7432C6.285 10.7397 6.63375 9.9092 7.20749 9.26326C7.1175 9.03257 6.8025 8.08674 7.2975 6.81794C7.2975 6.81794 8.05125 6.57571 9.77249 7.76377C10.4925 7.55615 11.2575 7.45234 12.0225 7.45234C12.7875 7.45234 13.5525 7.55615 14.2725 7.76377C15.9937 6.56418 16.7475 6.81794 16.7475 6.81794C17.2424 8.08674 16.9275 9.03257 16.8375 9.26326C17.4113 9.9092 17.76 10.7281 17.76 11.7432C17.76 15.2843 15.6563 16.0687 13.6537 16.2993C13.98 16.5877 14.2613 17.1414 14.2613 18.0065C14.2613 19.2407 14.25 20.2326 14.25 20.5441C14.25 20.7863 14.4188 21.0746 14.8688 20.9824C16.6554 20.364 18.2079 19.1866 19.3078 17.6162C20.4077 16.0457 20.9995 14.1611 21 12.2276C21 7.12937 16.9725 3 12 3Z"></path></svg><span class="nx-sr-only">GitHub</span><span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a><button type="button" aria-label="Menu" class="nextra-hamburger -nx-mr-2 nx-rounded nx-p-2 active:nx-bg-gray-400/20 md:nx-hidden"><svg fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" class=""><g><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16"></path></g><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 12h16"></path><g><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 18h16"></path></g></svg></button></nav></div><div class="nx-mx-auto nx-flex nx-max-w-[90rem]"><div class="motion-reduce:nx-transition-none [transition:background-color_1.5s_ease] nx-bg-transparent"></div><aside class="nextra-sidebar-container nx-flex nx-flex-col md:nx-top-16 md:nx-shrink-0 motion-reduce:nx-transform-none nx-transform-gpu nx-transition-all nx-ease-in-out print:nx-hidden md:nx-w-64 md:nx-sticky md:nx-self-start max-md:[transform:translate3d(0,-100%,0)]"><div class="nx-px-4 nx-pt-4 md:nx-hidden"><div class="nextra-search nx-relative md:nx-w-64"><div class="nx-relative nx-flex nx-items-center nx-text-gray-900 contrast-more:nx-text-gray-800 dark:nx-text-gray-300 contrast-more:dark:nx-text-gray-300"><input spellcheck="false" class="nx-block nx-w-full nx-appearance-none nx-rounded-lg nx-px-3 nx-py-2 nx-transition-colors nx-text-base nx-leading-tight md:nx-text-sm nx-bg-black/[.05] dark:nx-bg-gray-50/10 focus:nx-bg-white dark:focus:nx-bg-dark placeholder:nx-text-gray-500 dark:placeholder:nx-text-gray-400 contrast-more:nx-border contrast-more:nx-border-current" type="search" placeholder="Search documentation…" value=""/></div></div></div><div class="nx-overflow-y-auto nx-overflow-x-hidden nx-p-4 nx-grow md:nx-h-[calc(100vh-var(--nextra-navbar-height)-var(--nextra-menu-height))] nextra-scrollbar"><div class="nx-transform-gpu nx-overflow-hidden nx-transition-all nx-ease-in-out motion-reduce:nx-transition-none"><div class="nx-transition-opacity nx-duration-500 nx-ease-in-out motion-reduce:nx-transition-none nx-opacity-100"><ul class="nx-flex nx-flex-col nx-gap-1 nextra-menu-desktop max-md:nx-hidden"><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/introduction">Introduction</a></li><li class="open"><a class="nx-items-center nx-justify-between nx-gap-2 nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started">Getting Started<svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-h-[18px] nx-min-w-[18px] nx-rounded-sm nx-p-0.5 hover:nx-bg-gray-800/5 dark:hover:nx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="nx-origin-center nx-transition-transform rtl:-nx-rotate-180 ltr:nx-rotate-90 rtl:nx-rotate-[-270deg]"></path></svg></a><div class="nx-transform-gpu nx-overflow-hidden nx-transition-all nx-ease-in-out motion-reduce:nx-transition-none"><div class="nx-transition-opacity nx-duration-500 nx-ease-in-out motion-reduce:nx-transition-none nx-opacity-100 ltr:nx-pr-0 rtl:nx-pl-0 nx-pt-1"><ul class="nx-flex nx-flex-col nx-gap-1 nx-relative before:nx-absolute before:nx-inset-y-1 before:nx-w-px before:nx-bg-gray-200 before:nx-content-[&quot;&quot;] dark:before:nx-bg-neutral-800 ltr:nx-pl-3 ltr:before:nx-left-0 rtl:nx-pr-3 rtl:before:nx-right-0 ltr:nx-ml-3 rtl:nx-mr-3"><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started/how-to-build">How to build Atlas?</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started/smart-contract-intro">Smart Contract</a></li><li class="nx-flex nx-flex-col nx-gap-1 active"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-bg-primary-100 nx-font-semibold nx-text-primary-800 dark:nx-bg-primary-400/10 dark:nx-text-primary-600 contrast-more:nx-border-primary-500 contrast-more:dark:nx-border-primary-500" href="/getting-started/operations">Operations over Contract</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started/unit-tests">Unit Tests</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started/integration-tests">Integration Tests</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started/endpoints">Creating Endpoints</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/getting-started/browser-integration">Browser Integration</a></li></ul></div></div></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/more-tutorials">More Tutorials</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a href="https://haddock.atlas-app.io/" target="_blank" rel="noreferrer" class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50">API Reference (Haddock) ⬈<span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a></li></ul></div></div></div><div class="nx-sticky nx-bottom-0 nx-bg-white dark:nx-bg-dark nx-mx-4 nx-py-4 nx-shadow-[0_-12px_16px_#fff] nx-flex nx-items-center nx-gap-2 dark:nx-border-neutral-800 dark:nx-shadow-[0_-12px_16px_#111] contrast-more:nx-border-neutral-400 contrast-more:nx-shadow-none contrast-more:dark:nx-shadow-none nx-border-t" data-toggle-animation="off"><button title="Hide sidebar" class="max-md:nx-hidden nx-h-7 nx-rounded-md nx-transition-colors nx-text-gray-600 dark:nx-text-gray-400 nx-px-2 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50"><svg height="12" width="12" viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" d="M4.177 7.823l2.396-2.396A.25.25 0 017 5.604v4.792a.25.25 0 01-.427.177L4.177 8.177a.25.25 0 010-.354z" class=""></path><path fill-rule="evenodd" d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0114.25 16H1.75A1.75 1.75 0 010 14.25V1.75zm1.75-.25a.25.25 0 00-.25.25v12.5c0 .138.112.25.25.25H9.5v-13H1.75zm12.5 13H11v-13h3.25a.25.25 0 01.25.25v12.5a.25.25 0 01-.25.25z"></path></svg></button></div></aside><nav class="nextra-toc nx-order-last nx-hidden nx-w-64 nx-shrink-0 xl:nx-block print:nx-hidden nx-px-4" aria-label="table of contents"><div class="nextra-scrollbar nx-sticky nx-top-16 nx-overflow-y-auto nx-pr-4 nx-pt-6 nx-text-sm [hyphens:auto] nx-max-h-[calc(100vh-var(--nextra-navbar-height)-env(safe-area-inset-bottom))] ltr:-nx-mr-4 rtl:-nx-ml-4"><p class="nx-mb-4 nx-font-semibold nx-tracking-tight">On This Page</p><ul><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#operation-1-generating-address-for-our-smart-contract" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Operation 1: Generating address for our Smart Contract</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#generating-validator-for-our-smart-contract" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Generating Validator for our Smart Contract</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#interlude---gytxquerymonad" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Interlude - GYTxQueryMonad</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#generating-address" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Generating address</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#operation-2-adding-input-to-refer-later-reference-input" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Operation 2: Adding Input to refer later (Reference Input)</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#interlude---gytxskeleton" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Interlude - GYTxSkeleton</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#skeleton-for-adding-reference-input" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Skeleton for adding reference input</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#q-can-you-create-a-skeleton-for-adding-reference-script" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Q: Can you create a skeleton for adding reference script?</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#operation-3-placing-a-bet" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Operation 3: Placing a bet</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#placing-the-first-bet" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Placing the first bet</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#placing-subsequent-bets" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Placing subsequent bets</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#operation-4-taking-the-bet-pot" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Operation 4: Taking the bet pot</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#additional-useful-functions" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Additional Useful Functions</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#utxosdatums" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">utxosDatums</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#mustmint" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">mustMint</a></li></ul><div class="nx-mt-8 nx-border-t nx-bg-white nx-pt-8 nx-shadow-[0_-12px_16px_white] dark:nx-bg-dark dark:nx-shadow-[0_-12px_16px_#111] nx-sticky nx-bottom-0 nx-flex nx-flex-col nx-items-start nx-gap-2 nx-pb-8 dark:nx-border-neutral-800 contrast-more:nx-border-t contrast-more:nx-border-neutral-400 contrast-more:nx-shadow-none contrast-more:dark:nx-border-neutral-400"><a href="https://github.com/geniusyield/atlas-docs/issues/new?title=Feedback%20for%20%E2%80%9COperations%20over%20Contract%E2%80%9D&amp;labels=feedback" target="_blank" rel="noreferrer" class="nx-text-xs nx-font-medium nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-100 contrast-more:nx-text-gray-800 contrast-more:dark:nx-text-gray-50">Question? Give us feedback →<span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a><a class="nx-text-xs nx-font-medium nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-100 contrast-more:nx-text-gray-800 contrast-more:dark:nx-text-gray-50" href="https://github.com/geniusyield/atlas-docs/tree/main/src/pages/getting-started/operations.mdx">Edit this page</a></div></div></nav><div id="reach-skip-nav"></div><article class="nx-w-full nx-break-words nextra-content nx-flex nx-min-h-[calc(100vh-var(--nextra-navbar-height))] nx-min-w-0 nx-justify-center nx-pb-8 nx-pr-[calc(env(safe-area-inset-right)-1.5rem)]"><main class="nx-w-full nx-min-w-0 nx-max-w-6xl nx-px-6 nx-pt-4 md:nx-px-12"><div class="nextra-breadcrumb nx-mt-1.5 nx-flex nx-items-center nx-gap-1 nx-overflow-hidden nx-text-sm nx-text-gray-500 dark:nx-text-gray-400 contrast-more:nx-text-current"><div class="nx-whitespace-nowrap nx-transition-colors nx-min-w-[24px] nx-overflow-hidden nx-text-ellipsis hover:nx-text-gray-900 dark:hover:nx-text-gray-100" title="Getting Started"><a href="/getting-started">Getting Started</a></div><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-w-3.5 nx-shrink-0"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg><div class="nx-whitespace-nowrap nx-transition-colors nx-font-medium nx-text-gray-700 contrast-more:nx-font-bold contrast-more:nx-text-current dark:nx-text-gray-100 contrast-more:dark:nx-text-current" title="Operations over Contract">Operations over Contract</div></div><h1 class="nx-mt-2 nx-text-4xl nx-font-bold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100">Operations over Contract</h1>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Having understood the contract. Now is the time we actually start using our framework to build the transactions for it.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">The main principle to understand here is that - we only need to give the essentials, i.e. we only specify what we <em>want</em> and it is the job of the framework to do the rest.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">For instance, we may tell that we want to consume a specific input belonging to the script&#x27;s address and generate a specific output. Given that, it becomes framework&#x27;s job to do the rest, say:</p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">Select available UTxO&#x27;s in user&#x27;s wallet and generate suitable change output to balance the transaction, considering fees.</li>
<li class="nx-my-2">Make sure all generated UTxO&#x27;s satisfy minimum ada requirement.</li>
<li class="nx-my-2">Handle collateral.</li>
<li class="nx-my-2">etc, etc.</li>
</ul>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Thus, we only specify at high-level what we want. This would become clear as we actually start writing operations for our contract.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Entire code for these operations is available <a href="https://github.com/geniusyield/atlas-examples/tree/main/bet-ref/server-lib/BetRef/Api/Operations.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">here<span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a>.</p>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">Operation <em>1</em>: Generating address for our Smart Contract<a href="#operation-1-generating-address-for-our-smart-contract" id="operation-1-generating-address-for-our-smart-contract" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Generating Validator for our Smart Contract<a href="#generating-validator-for-our-smart-contract" id="generating-validator-for-our-smart-contract" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Following the usual drill, we generate the Validator given contract parameters (following is written in file <a href="https://github.com/geniusyield/atlas-examples/tree/main/bet-ref/onchain/BetRef/OnChain/BetRef/Compiled.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">Compiled.hs</code><span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a>):</p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><div class="nx-absolute nx-top-0 nx-z-[1] nx-w-full nx-truncate nx-rounded-t-xl nx-bg-primary-700/5 nx-py-2 nx-px-4 nx-text-xs nx-text-gray-700 dark:nx-bg-primary-300/10 dark:nx-text-gray-200">Compiled.hs</div><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-pt-12 nx-pb-4" data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">-- | Generates validator given params.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">betRefValidator</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">BetRefParams</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Validator</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">betRefValidator betRefParams </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> mkValidatorScript </span><span style="color:var(--shiki-token-keyword)">$</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">$$</span><span style="color:var(--shiki-color-text)">(PlutusTx.compile </span><span style="color:var(--shiki-token-keyword)">[||</span><span style="color:var(--shiki-color-text)"> mkBetRefValidator</span><span style="color:var(--shiki-token-keyword)">||]</span><span style="color:var(--shiki-color-text)">) </span><span style="color:var(--shiki-token-keyword)">`PlutusTx.applyCode`</span><span style="color:var(--shiki-color-text)"> PlutusTx.liftCode betRefParams</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-8"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50" title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">What we have obtained is of type <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">Validator</code>, defined in <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">plutus-ledger-api</code>, which is nothing but a wrapper around <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">Script</code> type defined in same.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Likewise, we have our own types, <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">GYValidator</code> (similarly <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">GYMintingPolicy</code> for minting policy scripts) &amp; <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">GYScript</code> (defined in <a href="https://github.com/geniusyield/atlas/tree/main/src/GeniusYield/Types/Script.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">Script.hs</code><span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a>) to represent these in our framework.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">The file mentioned <a href="https://github.com/geniusyield/atlas/tree/main/src/GeniusYield/Types/Script.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">Script.hs</code><span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a> contains a lot of helper utilities such as <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">validatorFromPlutus</code> which takes in Plutus&#x27;s <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">Validator</code> type to give out <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">GYValidator</code>. Though there has been slight abuse in mentioning type here as what is actually given out is <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">GYValidator v</code> where type variable <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">v</code> is of <em>kind</em> <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">PlutusVersion</code> which is defined in file <a href="https://github.com/geniusyield/atlas/tree/main/src/GeniusYield/Types/PlutusVersion.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">PlutusVersion.hs</code><span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a> which you can understand as being here to denote plutus version for our validator script<sup><a class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]" id="user-content-fnref-1" data-footnote-ref="true" aria-describedby="footnote-label" href="/getting-started/operations#user-content-fn-1">1</a></sup>.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">If we look at the type signature of <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">validatorFromPlutus</code>, we see: <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">validatorFromPlutus :: forall v. SingPlutusVersionI v =&gt; Plutus.Validator -&gt; GYValidator v</code> where for the time being we can ignore the description of the typeclass <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">SingPlutusVersionI</code><sup><a class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]" id="user-content-fnref-1-2" data-footnote-ref="true" aria-describedby="footnote-label" href="/getting-started/operations#user-content-fn-1">1</a></sup> besides noting the fact that only types (currently <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">&#x27;PlutusV1</code> &amp; <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">&#x27;PlutusV2</code>) of kind <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">PlutusVersion</code> have an instance for it. So here, our function <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">validatorFromPlutus</code> works for all type variable <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">v</code> which have an instance of <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">SingPlutusVersionI</code> but there is no way to learn what this <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">v</code> is based solely on the input <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">Plutus.Validator</code> and therefore, caller must specify it, either by providing type signature (of callee or caller due to type inference) or by using <a href="https://ghc.gitlab.haskell.org/ghc/doc/users_guide/exts/type_applications.html" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">visible type application<span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a>. Our first operation does make use of it but before looking at it, we need to understand about <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">GYTxQueryMonad</code>.</p>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Interlude - <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">GYTxQueryMonad</code><a href="#interlude---gytxquerymonad" id="interlude---gytxquerymonad" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">When we want to obtain the address of the script from its hash, besides the hash, we also need to know the network we are currently operating at. Is it some testnet or mainnet?</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Similarly, transaction building involves querying the ledger for various information like say querying UTxO&#x27;s present at one&#x27;s address, similarly it might need help of some chain indexer to query datum in case output contains only the datum&#x27;s hash.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">All of this is captured by typeclass <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">GYTxQueryMonad</code> defined <a href="https://github.com/geniusyield/atlas/tree/main/src/GeniusYield/TxBuilder/Class.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">here<span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a> and also shown below (kindly see all these functions defined for this typeclass).</p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">-- | Class of monads for querying chain data.</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">class</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">MonadError</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxMonadException</span><span style="color:var(--shiki-color-text)"> m </span><span style="color:var(--shiki-token-keyword)">=&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxQueryMonad</span><span style="color:var(--shiki-color-text)"> m </span><span style="color:var(--shiki-token-keyword)">where</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    {-# </span><span style="color:var(--shiki-token-keyword)">MINIMAL</span><span style="color:var(--shiki-color-text)"> networkId, lookupDatum, (utxoAtTxOutRef | utxosAtTxOutRefs), (utxosAtAddress | utxosAtAddresses), slotConfig, currentSlot, logMsg #-}</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">    -- | Get the network id</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-function)">networkId</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> m </span><span style="color:var(--shiki-token-keyword)">GYNetworkId</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">    -- | Lookup datum by its hash.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-function)">lookupDatum</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYDatumHash</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> m (</span><span style="color:var(--shiki-token-keyword)">Maybe</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYDatum</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">    -- | Lookup &#x27;GYUTxO&#x27; at &#x27;GYTxOutRef&#x27;.</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)">    --</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-function)">utxoAtTxOutRef</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxOutRef</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> m (</span><span style="color:var(--shiki-token-keyword)">Maybe</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYUTxO</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    utxoAtTxOutRef ref </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        utxos </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> utxosAtTxOutRefs [ref]</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        return </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> utxosToList utxos </span><span style="color:var(--shiki-token-keyword)">of</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">[]</span><span style="color:var(--shiki-color-text)">       </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> Nothing</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            utxo </span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> _ </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> Just utxo</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">    -- | Lookup &#x27;GYUTxOs&#x27; at multiple &#x27;GYTxOutRef&#x27;s at once</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-function)">utxosAtTxOutRefs</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> [</span><span style="color:var(--shiki-token-keyword)">GYTxOutRef</span><span style="color:var(--shiki-color-text)">] </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> m </span><span style="color:var(--shiki-token-keyword)">GYUTxOs</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    utxosAtTxOutRefs orefs </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> utxosFromList </span><span style="color:var(--shiki-token-keyword)">&lt;$&gt;</span><span style="color:var(--shiki-color-text)"> wither utxoAtTxOutRef orefs</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">    -- | Lookup &#x27;GYUTxOs&#x27; at &#x27;GYAddress&#x27;.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-function)">utxosAtAddress</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYAddress</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> m </span><span style="color:var(--shiki-token-keyword)">GYUTxOs</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    utxosAtAddress </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> utxosAtAddresses </span><span style="color:var(--shiki-token-keyword)">.</span><span style="color:var(--shiki-color-text)"> return</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">    -- | Lookup &#x27;GYUTxOs&#x27; at zero or more &#x27;GYAddress&#x27;.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-function)">utxosAtAddresses</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> [</span><span style="color:var(--shiki-token-keyword)">GYAddress</span><span style="color:var(--shiki-color-text)">] </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> m </span><span style="color:var(--shiki-token-keyword)">GYUTxOs</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    utxosAtAddresses </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> foldM f mempty</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      </span><span style="color:var(--shiki-token-keyword)">where</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-function)">f</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYUTxOs</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYAddress</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> m </span><span style="color:var(--shiki-token-keyword)">GYUTxOs</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        f utxos addr </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">&lt;&gt;</span><span style="color:var(--shiki-color-text)"> utxos) </span><span style="color:var(--shiki-token-keyword)">&lt;$&gt;</span><span style="color:var(--shiki-color-text)"> utxosAtAddress addr</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">    -- | Lookup the `[GYTxOutRef]`s at a `GYAddress`</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-function)">utxoRefsAtAddress</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYAddress</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> m [</span><span style="color:var(--shiki-token-keyword)">GYTxOutRef</span><span style="color:var(--shiki-color-text)">]</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    utxoRefsAtAddress </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> fmap (Map.keys </span><span style="color:var(--shiki-token-keyword)">.</span><span style="color:var(--shiki-color-text)"> mapUTxOs id) </span><span style="color:var(--shiki-token-keyword)">.</span><span style="color:var(--shiki-color-text)"> utxosAtAddress</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">{- | Obtain the slot config for the network.</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">    Implementations using era history to create slot config may raise &#x27;GYEraSummariesToSlotConfigError&#x27;.</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)">    -}</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-function)">slotConfig</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> m </span><span style="color:var(--shiki-token-keyword)">GYSlotConfig</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">    -- | Lookup the current &#x27;GYSlot&#x27;.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-function)">currentSlot</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> m </span><span style="color:var(--shiki-token-keyword)">GYSlot</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">    -- | Log a message with specified namespace and severity.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-function)">logMsg</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">HasCallStack</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYLogNamespace</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYLogSeverity</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> m </span><span style="color:var(--shiki-token-constant)">()</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50" title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">So, if we are working inside a monad which happens to also provide an instance for it, we would happily be able to query such an information.</p>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Generating address<a href="#generating-address" id="generating-address" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">In this operation, we only need to obtain network details with the help of this monad. Here is the code to obtain address (notice that we have provided multiple versions of the same code here):</p>
<div class="nextra-callout nx-overflow-x-auto nx-mt-6 nx-flex nx-rounded-lg nx-border nx-py-2 ltr:nx-pr-4 rtl:nx-pl-4 contrast-more:nx-border-current contrast-more:dark:nx-border-current nx-border-blue-200 nx-bg-blue-100 nx-text-blue-900 dark:nx-border-blue-200/30 dark:nx-bg-blue-900/30 dark:nx-text-blue-200"><div class="nx-select-none nx-text-xl ltr:nx-pl-3 ltr:nx-pr-2 rtl:nx-pr-3 rtl:nx-pl-2" style="font-family:&quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" width="20" height="20" class="nx-mt-1"><path fill-rule="evenodd" clip-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"></path></svg></div><div class="nx-w-full nx-min-w-0 nx-leading-7"><p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Type of <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">scriptAddress</code> used below (&amp; defined in <a href="https://github.com/geniusyield/atlas/tree/main/src/GeniusYield/TxBuilder/Class.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">Class.hs</code><span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a>) is <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">scriptAddress :: forall (m :: * -&gt; *) (v :: PlutusVersion). GYTxQueryMonad m =&gt; GYValidator v -&gt; m GYAddress</code>. Thus with respect to type application, the first parameter is for monad and second one is <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">PlutusVersion</code> kinded.</p><p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Internally this function queries for network details.</p></div></div>
<button type="button" aria-hidden="true" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0"></button><div class="nextra-scrollbar nx-overflow-x-auto nx-overflow-y-hidden nx-overscroll-x-contain"><div class="nx-mt-4 nx-flex nx-w-max nx-min-w-full nx-border-b nx-border-gray-200 nx-pb-px dark:nx-border-neutral-800" role="tablist" aria-orientation="horizontal"><button class="nx-mr-2 nx-rounded-t nx-p-2 nx-font-medium nx-leading-5 nx-transition-colors -nx-mb-0.5 nx-select-none nx-border-b-2 nx-border-primary-500 nx-text-primary-600" id="headlessui-tabs-tab-:R5hhd5l6:" role="tab" type="button" aria-selected="true" tabindex="0" data-headlessui-state="selected">A</button><button class="nx-mr-2 nx-rounded-t nx-p-2 nx-font-medium nx-leading-5 nx-transition-colors -nx-mb-0.5 nx-select-none nx-border-b-2 nx-border-transparent nx-text-gray-600 hover:nx-border-gray-200 hover:nx-text-black dark:nx-text-gray-200 dark:hover:nx-border-neutral-800 dark:hover:nx-text-white" id="headlessui-tabs-tab-:R9hhd5l6:" role="tab" type="button" aria-selected="false" tabindex="-1" data-headlessui-state="">B</button><button class="nx-mr-2 nx-rounded-t nx-p-2 nx-font-medium nx-leading-5 nx-transition-colors -nx-mb-0.5 nx-select-none nx-border-b-2 nx-border-transparent nx-text-gray-600 hover:nx-border-gray-200 hover:nx-text-black dark:nx-text-gray-200 dark:hover:nx-border-neutral-800 dark:hover:nx-text-white" id="headlessui-tabs-tab-:Rdhhd5l6:" role="tab" type="button" aria-selected="false" tabindex="-1" data-headlessui-state="">C</button></div></div><div><div class="nx-rounded nx-pt-6" id="headlessui-tabs-panel-:R6hhd5l6:" role="tabpanel" tabindex="0" data-headlessui-state="selected"><div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">-- A. Type is given by `scriptAddress`.</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Validator in question, obtained after giving required parameters.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">betRefValidator&#x27;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">SingPlutusVersionI</span><span style="color:var(--shiki-color-text)"> v </span><span style="color:var(--shiki-token-keyword)">=&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">BetRefParams</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYValidator</span><span style="color:var(--shiki-color-text)"> v</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">betRefValidator&#x27; brp </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> validatorFromPlutus </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> betRefValidator brp</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- | Address of the validator, given params.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">betRefAddress</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">HasCallStack</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxQueryMonad</span><span style="color:var(--shiki-color-text)"> m) </span><span style="color:var(--shiki-token-keyword)">=&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">BetRefParams</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> m </span><span style="color:var(--shiki-token-keyword)">GYAddress</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">betRefAddress brp </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> scriptAddress </span><span style="color:var(--shiki-token-keyword)">@</span><span style="color:var(--shiki-color-text)">_ </span><span style="color:var(--shiki-token-keyword)">@&#x27;PlutusV2</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> betRefValidator&#x27; brp</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50" title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div></div><span aria-hidden="true" id="headlessui-tabs-panel-:Rahhd5l6:" role="tabpanel" tabindex="-1" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0"></span><span aria-hidden="true" id="headlessui-tabs-panel-:Rehhd5l6:" role="tabpanel" tabindex="-1" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0"></span></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Well what is this monad <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">m</code> being used here? Well any! As long as it has an instance for <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">GYTxQueryMonad</code>. When we will start writing tests, then we&#x27;ll use all of these operations and most likely how to use them would become clear then.</p>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">Operation <em>2</em>: Adding Input to refer later (Reference Input)<a href="#operation-2-adding-input-to-refer-later-reference-input" id="operation-2-adding-input-to-refer-later-reference-input" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Interlude - <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">GYTxSkeleton</code><a href="#interlude---gytxskeleton" id="interlude---gytxskeleton" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">As mentioned before, we just mention at high level what we want in a transaction. This is captured by <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">GYTxSkeleton</code> defined <a href="https://github.com/geniusyield/atlas/tree/main/src/GeniusYield/TxBuilder/Class.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">here<span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a> and its description is mentioned below.</p>
<table class="nx-block nx-overflow-x-scroll nextra-scrollbar nx-mt-6 nx-p-0 first:nx-mt-0"><thead><tr class="nx-m-0 nx-border-t nx-border-gray-300 nx-p-0 dark:nx-border-gray-600 even:nx-bg-gray-100 even:dark:nx-bg-gray-600/20"><th class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 nx-font-semibold dark:nx-border-gray-600">Fields</th><th class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 nx-font-semibold dark:nx-border-gray-600">Represented by</th><th class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 nx-font-semibold dark:nx-border-gray-600">Additional details</th></tr></thead><tbody><tr class="nx-m-0 nx-border-t nx-border-gray-300 nx-p-0 dark:nx-border-gray-600 even:nx-bg-gray-100 even:dark:nx-bg-gray-600/20"><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600">Inputs</td><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">gytxIns</code></td><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600">It is a list of inputs where for each input, we have its UTxO reference (the &quot;TxIn&quot; as the <a href="https://github.com/input-output-hk/cardano-ledger/releases/latest/download/byron-ledger.pdf" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">cardano ledger specification<span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a> calls it) and a witness. In case this UTxO doesn&#x27;t belong to a script, we just need spending key witness, otherwise we need the associated script, its datum and input redeemer where the associated script could be provided as part of this transaction body or could be obtained from reference input. See <a href="https://github.com/geniusyield/atlas/tree/main/src/GeniusYield/Types/TxIn.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">TxIn.hs</code><span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a>.</td></tr><tr class="nx-m-0 nx-border-t nx-border-gray-300 nx-p-0 dark:nx-border-gray-600 even:nx-bg-gray-100 even:dark:nx-bg-gray-600/20"><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600">Outputs</td><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">gytxOuts</code></td><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600">List of outputs produced by this transaction where for each output we can mention whether the datum is to be inlined or not and whether this output stores any script. See <a href="https://github.com/geniusyield/atlas/tree/main/src/GeniusYield/Types/TxOut.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">TxOut.hs</code><span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a>.</td></tr><tr class="nx-m-0 nx-border-t nx-border-gray-300 nx-p-0 dark:nx-border-gray-600 even:nx-bg-gray-100 even:dark:nx-bg-gray-600/20"><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600">Reference Inputs</td><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">gytxRefIns</code></td><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600">Set of reference to UTxOs corresponding to reference inputs. Defined in same file, viz. <a href="https://github.com/geniusyield/atlas/tree/main/src/GeniusYield/TxBuilder/Class.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">Class.hs</code><span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a>.</td></tr><tr class="nx-m-0 nx-border-t nx-border-gray-300 nx-p-0 dark:nx-border-gray-600 even:nx-bg-gray-100 even:dark:nx-bg-gray-600/20"><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600">Mints</td><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">gytxMint</code></td><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600">Map of minting policy to pair of redeemer and another map for token name to mint amount for that token.</td></tr><tr class="nx-m-0 nx-border-t nx-border-gray-300 nx-p-0 dark:nx-border-gray-600 even:nx-bg-gray-100 even:dark:nx-bg-gray-600/20"><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600">Signatories</td><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">gytxSigs</code></td><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600">Set of Public Key Hash of Signatories.</td></tr><tr class="nx-m-0 nx-border-t nx-border-gray-300 nx-p-0 dark:nx-border-gray-600 even:nx-bg-gray-100 even:dark:nx-bg-gray-600/20"><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600">Valid after</td><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">gytxInvalidBefore</code></td><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600">Just the corresponding node slot.</td></tr><tr class="nx-m-0 nx-border-t nx-border-gray-300 nx-p-0 dark:nx-border-gray-600 even:nx-bg-gray-100 even:dark:nx-bg-gray-600/20"><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600">Valid before</td><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">gytxInvalidAfter</code></td><td class="nx-m-0 nx-border nx-border-gray-300 nx-px-4 nx-py-2 dark:nx-border-gray-600">Same as above.</td></tr></tbody></table>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Corresponding snippet of haskell code:</p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-token-keyword)">data</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxSkeleton</span><span style="color:var(--shiki-color-text)"> (v </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">PlutusVersion</span><span style="color:var(--shiki-color-text)">) </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> GYTxSkeleton</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    { gytxIns           </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-color-text)">[</span><span style="color:var(--shiki-token-keyword)">GYTxIn</span><span style="color:var(--shiki-color-text)"> v]</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    , gytxOuts          </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-color-text)">[</span><span style="color:var(--shiki-token-keyword)">GYTxOut</span><span style="color:var(--shiki-color-text)"> v]</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    , gytxRefIns        </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">GYTxSkeletonRefIns</span><span style="color:var(--shiki-color-text)"> v)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    , gytxMint          </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">Map</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">Some</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYMintingPolicy</span><span style="color:var(--shiki-color-text)">) (</span><span style="color:var(--shiki-token-keyword)">Map</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTokenName</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Integer</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYRedeemer</span><span style="color:var(--shiki-color-text)">))</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    , gytxSigs          </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">Set</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYPubKeyHash</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    , gytxInvalidBefore </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">Maybe</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYSlot</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    , gytxInvalidAfter  </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">Maybe</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYSlot</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    } </span><span style="color:var(--shiki-token-keyword)">deriving</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Show</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50" title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">When constructing the transaction, we just need to specify what we want in this skeleton.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">This skeleton naturally has a monoid instance where two skeletons are combined by running <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">mappend</code> over each of their fields. We have utility functions defined in the same file <a href="https://github.com/geniusyield/atlas/tree/main/src/GeniusYield/TxBuilder/Class.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">Class.hs</code><span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a> like (note that there are other helpful functions defined in the same file and it would in general be useful to go over them):</p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-token-function)">mustHaveOutput</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxOut</span><span style="color:var(--shiki-color-text)"> v </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxSkeleton</span><span style="color:var(--shiki-color-text)"> v</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">mustHaveOutput o </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> emptyGYTxSkeleton {gytxOuts </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> [o]}</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-function)">mustHaveInput</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxIn</span><span style="color:var(--shiki-color-text)"> v </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxSkeleton</span><span style="color:var(--shiki-color-text)"> v</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">mustHaveInput i </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> emptyGYTxSkeleton {gytxIns </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> [i]}</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-function)">mustHaveRefInput</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">VersionIsGreaterOrEqual</span><span style="color:var(--shiki-color-text)"> v </span><span style="color:var(--shiki-token-keyword)">PlutusV2</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxOutRef</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxSkeleton</span><span style="color:var(--shiki-color-text)"> v</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">mustHaveRefInput i </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> emptyGYTxSkeleton { gytxRefIns </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> GYTxSkeletonRefIns (Set.singleton i) }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-function)">mustMint</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYMintingPolicy</span><span style="color:var(--shiki-color-text)"> u </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYRedeemer</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTokenName</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Integer</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxSkeleton</span><span style="color:var(--shiki-color-text)"> v</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">mustMint p r tn n </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> emptyGYTxSkeleton {gytxMint </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> Map.singleton (Some p) (Map.singleton tn n</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> r)}</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-function)">mustBeSignedBy</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYPubKeyHash</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxSkeleton</span><span style="color:var(--shiki-color-text)"> v</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">mustBeSignedBy pkh </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> emptyGYTxSkeleton {gytxSigs </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> Set.singleton pkh}</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-function)">isInvalidBefore</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYSlot</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxSkeleton</span><span style="color:var(--shiki-color-text)"> v</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">isInvalidBefore s </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> emptyGYTxSkeleton {gytxInvalidBefore </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> Just s}</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-function)">isInvalidAfter</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYSlot</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxSkeleton</span><span style="color:var(--shiki-color-text)"> v</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">isInvalidAfter s </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> emptyGYTxSkeleton {gytxInvalidAfter </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> Just s}</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50" title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Thus we can specify that our transaction must have this output (using <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">mustHaveOutput</code>) and that output and must have this input (using <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">mustHaveInput</code>) and so on... and combine them all into a single skeleton using <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">mappend</code>.</p>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Skeleton for adding reference input<a href="#skeleton-for-adding-reference-input" id="skeleton-for-adding-reference-input" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Here we want to create an output at a given address (Oracle&#x27;s address) with the given datum. This UTxO is to be later used as a reference input by script where the script would refer to its datum. Here we have decided to keep this datum inline as currently framework is not supporting reading datum for a reference input whose output contains only datum hash<sup><a class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]" id="user-content-fnref-2" data-footnote-ref="true" aria-describedby="footnote-label" href="/getting-started/operations#user-content-fn-2">2</a></sup>.</p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">-- | Add UTxO to be used as reference input at a given address with given datum.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">addRefInput</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYAddress</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">OracleAnswerDatum</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxSkeleton</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">&#x27;PlutusV2</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">addRefInput addr dat </span><span style="color:var(--shiki-token-keyword)">=</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  mustHaveOutput </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> GYTxOut addr mempty (Just (datumFromPlutusData dat</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> GYTxOutUseInlineDatum)) Nothing</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-comment)">-- Note that the value can be empty as tx building logic would add the needed minimum UTxO ada.</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50" title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Note that we have mentioned the value as empty for this UTxO and this is one of the beauties of our framework that it will itself manage adding lovelaces to satisfy minimum ada requirement.</p>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Q: Can you create a skeleton for adding reference script?<a href="#q-can-you-create-a-skeleton-for-adding-reference-script" id="q-can-you-create-a-skeleton-for-adding-reference-script" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<details class="nx-my-4 nx-rounded nx-border nx-border-gray-200 nx-bg-white nx-p-2 nx-shadow-sm first:nx-mt-0 dark:nx-border-neutral-800 dark:nx-bg-neutral-900"><summary class="nx-flex nx-items-center nx-cursor-pointer nx-list-none nx-p-1 nx-transition-colors hover:nx-bg-gray-100 dark:hover:nx-bg-neutral-800 before:nx-mr-1 before:nx-inline-block before:nx-transition-transform before:nx-content-[&#x27;&#x27;] dark:before:nx-invert before:nx-shrink-0 rtl:before:nx-rotate-180 [[data-expanded]&gt;&amp;]:before:nx-rotate-90"> Toggle Answer </summary><div class="nx-transform-gpu nx-overflow-hidden nx-transition-all nx-ease-in-out motion-reduce:nx-transition-none" style="height:0"><div class="nx-transition-opacity nx-duration-500 nx-ease-in-out motion-reduce:nx-transition-none nx-opacity-0"><p class="nx-mt-6 nx-leading-7 first:nx-mt-0">
Given the output address <span data-rehype-pretty-code-fragment=""><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-token-function)">addr</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYAddress</span></span></code></span> and the Plutus V2 validator <span data-rehype-pretty-code-fragment=""><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-token-function)">script</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYValidator</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">&#x27;PlutusV2</span></span></code></span>, we can write <span data-rehype-pretty-code-fragment=""><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-color-text)">mustHaveOutput </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> GYTxOut addr mempty (Just (datumFromPlutusData </span><span style="color:var(--shiki-token-constant)">()</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> GYTxOutDontUseInlineDatum)) (Just </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> validatorToScript script)</span></span></code></span></p></div></div></details>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">Operation <em>3</em>: Placing a bet<a href="#operation-3-placing-a-bet" id="operation-3-placing-a-bet" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Placing the first bet<a href="#placing-the-first-bet" id="placing-the-first-bet" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">In case this is a first bet (a program handling the bets can decide whether the bet being placed by the user is first or not by querying the UTxOs at the script address), then we just need to produce an output at the script address with the bet value and our guess.</p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">-- | Operation to place bet.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">placeBet</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">HasCallStack</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxMonad</span><span style="color:var(--shiki-color-text)"> m)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">=&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxOutRef</span><span style="color:var(--shiki-color-text)">         </span><span style="color:var(--shiki-token-comment)">-- ^ Reference Script.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">BetRefParams</span><span style="color:var(--shiki-color-text)">       </span><span style="color:var(--shiki-token-comment)">-- ^ Validator Params.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">OracleAnswerDatum</span><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-comment)">-- ^ Guess.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYValue</span><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-comment)">-- ^ Bet amount to place.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYAddress</span><span style="color:var(--shiki-color-text)">          </span><span style="color:var(--shiki-token-comment)">-- ^ Own address.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Maybe</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxOutRef</span><span style="color:var(--shiki-color-text)">   </span><span style="color:var(--shiki-token-comment)">-- ^ Reference to previous bets UTxO (if any).</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> m (</span><span style="color:var(--shiki-token-keyword)">GYTxSkeleton</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">PlutusV2</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">placeBet refScript brp guess bet ownAddr mPreviousBetsUtxoRef </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  pkh </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> addressToPubKeyHash&#x27; ownAddr</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  betAddr </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> betRefAddress brp</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> mPreviousBetsUtxoRef </span><span style="color:var(--shiki-token-keyword)">of</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">-- This is the first bet.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    Nothing </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      return </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> mustHaveOutput </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> GYTxOut</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        { gyTxOutAddress </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> betAddr</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        , gyTxOutValue </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> bet</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        , gyTxOutDatum </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> Just (datumFromPlutusData </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> BetRefDatum [(pubKeyHashToPlutus pkh</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> guess)] (valueToPlutus bet)</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> GYTxOutDontUseInlineDatum)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        , gyTxOutRefS    </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> Nothing</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50" title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">At this point, it should be clear what is happening in the above code block. This function is somewhat overloaded and is handling both the cases whether the bet is first or not and it determines this using the presence of reference to a UTxO (representing previous bets) at validator script. In case there isn&#x27;t one, i.e., <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">Nothing</code> for our <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">Maybe</code> value, we are placing the first bet. Notice that we mention that our datum shouldn&#x27;t be inlined to output using <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">GYTxOutDontUseInlineDatum</code>.</p>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Placing subsequent bets<a href="#placing-subsequent-bets" id="placing-subsequent-bets" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Here we would be exercising script&#x27;s logic for the first time. We would be consuming the UTxO present at script address. We have defined a function, viz. <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">input</code> which would take in the following parameters:</p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">BetRefParams</code>: to generate the validator script or else we can read the script from the UTxO pertaining to reference script.</li>
<li class="nx-my-2">Reference to reference script UTxO.</li>
<li class="nx-my-2">Reference of script input to consume.</li>
<li class="nx-my-2">The datum present at this input. Recall that our datum was not inlined for this particular output, we therefore would need lookup the datum using <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">lookupDatum</code> to pass the actual datum to this function.</li>
<li class="nx-my-2">Redeemer action.</li>
</ul>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Thus, we have its definition as:</p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">-- | Utility function to consume script UTxO.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">input</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">BetRefParams</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxOutRef</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxOutRef</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">BetRefDatum</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">BetRefAction</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxSkeleton</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">&#x27;PlutusV2</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">input brp refScript inputRef dat red </span><span style="color:var(--shiki-token-keyword)">=</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  mustHaveInput GYTxIn</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    { gyTxInTxOutRef </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> inputRef</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    , gyTxInWitness  </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> GYTxInWitnessScript</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        (GYInReference refScript </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> validatorToScript </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> betRefValidator&#x27; brp)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        (datumFromPlutusData dat)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        (redeemerFromPlutusData red)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50" title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div>
<div class="nextra-callout nx-overflow-x-auto nx-mt-6 nx-flex nx-rounded-lg nx-border nx-py-2 ltr:nx-pr-4 rtl:nx-pl-4 contrast-more:nx-border-current contrast-more:dark:nx-border-current nx-border-blue-200 nx-bg-blue-100 nx-text-blue-900 dark:nx-border-blue-200/30 dark:nx-bg-blue-900/30 dark:nx-text-blue-200"><div class="nx-select-none nx-text-xl ltr:nx-pl-3 ltr:nx-pr-2 rtl:nx-pr-3 rtl:nx-pl-2" style="font-family:&quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" width="20" height="20" class="nx-mt-1"><path fill-rule="evenodd" clip-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"></path></svg></div><div class="nx-w-full nx-min-w-0 nx-leading-7"><p class="nx-mt-6 nx-leading-7 first:nx-mt-0">In case we didn&#x27;t want to use reference script, we would write <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">gyTxInWitness</code> as:</p><div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-color-text)">gyTxInWitness  </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> GYTxInWitnessScript</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        (GYInScript (validatorToScript </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> betRefValidator&#x27; brp))</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        (datumFromPlutusData dat)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        (redeemerFromPlutusData red)</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50" title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div></div></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Following is the complete code for handling this case. Few comments to facilitate its understanding:</p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">We first query the UTxO corresponding to previous bets at script address and we then query for its datum using <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">utxoDatum&#x27;</code> which tries its best to retrieve the datum and raises an exception in case it fails. This is its signature: <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">utxoDatum&#x27; :: (GYTxQueryMonad m, Plutus.FromData a) =&gt; GYUTxO -&gt; m (GYAddress, GYValue, a)</code>.</p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2"><em>Note</em>: <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">utxoAtTxOutRef&#x27;</code> (defined again in <a href="https://github.com/geniusyield/atlas/tree/main/src/GeniusYield/TxBuilder/Class.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">Class.hs</code><span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a>) is a wrapper around <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">utxoAtTxOutRef</code> which raises an exception in case the result was <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">Nothing</code>.</li>
</ul>
</li>
<li class="nx-my-2">
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">We then see the use of <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">gyLogDebug&#x27;</code> which as you would expect is for logging purposes. The first argument that it takes correspond to namespace as used by <a href="https://hackage.haskell.org/package/katip-0.8.7.2/docs/Katip-Core.html#t:Namespace" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">Katip</code><span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a>. This is where integration of off-chain and on-chain code really begins to shine ✨, having the <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">Show</code> instance defined for some of our on-chain types allows us to log them.</p>
</li>
<li class="nx-my-2">
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">timeFromPlutus</code> is as you&#x27;ll expect - gives us the framework&#x27;s representation of time from that of plutus. And <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">enclosingSlotFromTime&#x27;</code> uses ledger&#x27;s information to determine the corresponding slot for the given time. We need this as cardano&#x27;s node work in slots. We mention that our transaction is to be invalid after this slot using <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">isInvalidAfter</code>.</p>
</li>
<li class="nx-my-2">
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">We mention that our transaction must have our public key hash as signatories when plutus smart contract asks for it using <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">mustBeSignedBy</code>.</p>
</li>
<li class="nx-my-2">
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Lastly, this transaction must generate an output to the script&#x27;s address with the updated datum and added value.</p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">valueToPlutus</code> gives the corresponding value type used by plutus from what we have in our framework (viz., <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">GYValue</code>).</li>
</ul>
</li>
</ul>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">All these skeletons are combined together using <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">mappend</code> defined for <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">GYTxSkeleton</code>.</p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">-- Need to append to previous.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    Just previousBetsUtxoRef </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      previousUtxo </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> utxoAtTxOutRef&#x27; previousBetsUtxoRef</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      (_addr</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> previousValue</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> dat</span><span style="color:var(--shiki-token-keyword)">@</span><span style="color:var(--shiki-color-text)">(BetRefDatum previousGuesses _previousBet)) </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> utxoDatum&#x27; previousUtxo</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      gyLogDebug&#x27; </span><span style="color:var(--shiki-token-string-expression)">&quot;&quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> printf </span><span style="color:var(--shiki-token-string-expression)">&quot;previous guesses %s&quot;</span><span style="color:var(--shiki-color-text)"> (show previousGuesses)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      betUntilSlot </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> enclosingSlotFromTime&#x27; (timeFromPlutus </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> brpBetUntil brp)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      gyLogDebug&#x27; </span><span style="color:var(--shiki-token-string-expression)">&quot;&quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> printf </span><span style="color:var(--shiki-token-string-expression)">&quot;bet until slot %s&quot;</span><span style="color:var(--shiki-color-text)"> (show betUntilSlot)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      return </span><span style="color:var(--shiki-token-keyword)">$</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">           input brp refScript previousBetsUtxoRef dat (Bet guess)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">&lt;&gt;</span><span style="color:var(--shiki-color-text)"> mustHaveOutput GYTxOut</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              { gyTxOutAddress </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> betAddr</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              , gyTxOutValue </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> bet </span><span style="color:var(--shiki-token-keyword)">&lt;&gt;</span><span style="color:var(--shiki-color-text)"> previousValue</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              , gyTxOutDatum </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> Just (datumFromPlutusData </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> BetRefDatum ((pubKeyHashToPlutus pkh</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> guess) </span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> previousGuesses) (valueToPlutus bet)</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> GYTxOutDontUseInlineDatum)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              , gyTxOutRefS    </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> Nothing</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">&lt;&gt;</span><span style="color:var(--shiki-color-text)"> isInvalidAfter betUntilSlot</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">&lt;&gt;</span><span style="color:var(--shiki-color-text)"> mustBeSignedBy pkh</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50" title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">Operation <em>4</em>: Taking the bet pot<a href="#operation-4-taking-the-bet-pot" id="operation-4-taking-the-bet-pot" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">At this point, reading following code snippet should make sense as it is similar to what we have done before. Here note that we are using <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">mustHaveRefInput</code> to tell that the transaction must have the following UTxO reference as a reference input.</p>
<div class="nextra-callout nx-overflow-x-auto nx-mt-6 nx-flex nx-rounded-lg nx-border nx-py-2 ltr:nx-pr-4 rtl:nx-pl-4 contrast-more:nx-border-current contrast-more:dark:nx-border-current nx-border-orange-100 nx-bg-orange-50 nx-text-orange-800 dark:nx-border-orange-400/30 dark:nx-bg-orange-400/20 dark:nx-text-orange-300"><div class="nx-select-none nx-text-xl ltr:nx-pl-3 ltr:nx-pr-2 rtl:nx-pr-3 rtl:nx-pl-2" style="font-family:&quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;">💡</div><div class="nx-w-full nx-min-w-0 nx-leading-7"><p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Observe that we don&#x27;t need to specify that the value we successfully consume from the script&#x27;s UTxO must reach us because transaction balancer would add the change output to us.</p></div></div>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="haskell" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="haskell" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">-- | Operation to take UTxO corresponding to previous bets.</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">takeBets</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">::</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">HasCallStack</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxMonad</span><span style="color:var(--shiki-color-text)"> m)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">=&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxOutRef</span><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">-- ^ Reference Script.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">BetRefParams</span><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-comment)">-- ^ Validator params.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxOutRef</span><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">-- ^ Script UTxO to consume.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYAddress</span><span style="color:var(--shiki-color-text)">     </span><span style="color:var(--shiki-token-comment)">-- ^ Own address.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">GYTxOutRef</span><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">-- ^ Oracle reference input.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">              </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> m (</span><span style="color:var(--shiki-token-keyword)">GYTxSkeleton</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">PlutusV2</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">takeBets refScript brp previousBetsUtxoRef ownAddr oracleRefInput </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">do</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  pkh </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> addressToPubKeyHash&#x27; ownAddr</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  previousUtxo </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> utxoAtTxOutRef&#x27; previousBetsUtxoRef</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  (_addr</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> _previousValue</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> dat) </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> utxoDatum&#x27; previousUtxo</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  betRevealSlot </span><span style="color:var(--shiki-token-keyword)">&lt;-</span><span style="color:var(--shiki-color-text)"> enclosingSlotFromTime&#x27; (timeFromPlutus </span><span style="color:var(--shiki-token-keyword)">$</span><span style="color:var(--shiki-color-text)"> brpBetReveal brp)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  return </span><span style="color:var(--shiki-token-keyword)">$</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">       input brp refScript previousBetsUtxoRef dat Take</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">&lt;&gt;</span><span style="color:var(--shiki-color-text)"> isInvalidBefore betRevealSlot</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">&lt;&gt;</span><span style="color:var(--shiki-color-text)"> mustHaveRefInput oracleRefInput</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">&lt;&gt;</span><span style="color:var(--shiki-color-text)"> mustBeSignedBy pkh</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50" title="Copy code" tabindex="0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" class="nextra-copy-icon nx-pointer-events-none nx-h-4 nx-w-4"><rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">Additional Useful Functions<a href="#additional-useful-functions" id="additional-useful-functions" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">utxosDatums</code><a href="#utxosdatums" id="utxosdatums" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">Sometimes we want to see all <em>valid</em> UTxOs at our script address. In Cardano, anyone can form UTxO at any address and such a UTxO need not have valid datum as required by our script. <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">utxosDatums</code> can be used wither out invalid ones. See it&#x27;s usage in <a class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]" href="/more-tutorials#vesting">Vesting example</a>.</p>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">mustMint</code><a href="#mustmint" id="mustmint" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">We weren&#x27;t minting any tokens in our example here and thus didn&#x27;t make use of <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">mustMint</code> skeleton function. It&#x27;s sample usage is given in <a href="https://github.com/geniusyield/atlas/blob/main/src/GeniusYield/Api/TestTokens.hs" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">this<span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a> example. Which also illustrates how one can mint NFT and shows usage of <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">someUTxO</code> function which essentially gives some random UTxO belonging to wallet.</p>
<!-- -->
<section data-footnotes="true" class="footnotes"><h2 class="nx-sr-only">Footnotes<a href="#footnote-label" id="footnote-label" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<ol class="nx-mt-6 nx-list-decimal first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2" id="user-content-fn-1">
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">This is related to singletons and one can read about it from the &quot;Dependent Types&quot; chapter (the last one) in <a href="https://thinkingwithtypes.com/" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">Thinking with Types<span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a> book. <a class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font] data-footnote-backref" data-footnote-backref="true" aria-label="Back to content" href="/getting-started/operations#user-content-fnref-1">↩</a> <a class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font] data-footnote-backref" data-footnote-backref="true" aria-label="Back to content" href="/getting-started/operations#user-content-fnref-1-2">↩<sup>2</sup></a></p>
</li>
<li class="nx-my-2" id="user-content-fn-2">
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">This however is not true for normal inputs where you can specify the datum as we&#x27;ll see in other operations. <a class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font] data-footnote-backref" data-footnote-backref="true" aria-label="Back to content" href="/getting-started/operations#user-content-fnref-2">↩</a></p>
</li>
</ol>
</section><div class="nx-mt-16"></div><div class="nx-mb-8 nx-flex nx-items-center nx-border-t nx-pt-8 dark:nx-border-neutral-800 contrast-more:nx-border-neutral-400 dark:contrast-more:nx-border-neutral-400 print:nx-hidden"><a title="Smart Contract" class="nx-flex nx-max-w-[50%] nx-items-center nx-gap-1 nx-py-4 nx-text-base nx-font-medium nx-text-gray-600 nx-transition-colors [word-break:break-word] hover:nx-text-primary-600 dark:nx-text-gray-300 md:nx-text-lg ltr:nx-pr-4 rtl:nx-pl-4" href="/getting-started/smart-contract-intro"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-inline nx-h-5 nx-shrink-0 ltr:nx-rotate-180"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>Smart Contract</a><a title="Unit Tests" class="nx-flex nx-max-w-[50%] nx-items-center nx-gap-1 nx-py-4 nx-text-base nx-font-medium nx-text-gray-600 nx-transition-colors [word-break:break-word] hover:nx-text-primary-600 dark:nx-text-gray-300 md:nx-text-lg ltr:nx-ml-auto ltr:nx-pl-4 ltr:nx-text-right rtl:nx-mr-auto rtl:nx-pr-4 rtl:nx-text-left" href="/getting-started/unit-tests">Unit Tests<svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-inline nx-h-5 nx-shrink-0 rtl:nx-rotate-180"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></a></div></main></article></div></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{}},"page":"/getting-started/operations","query":{},"buildId":"VLgWUhfJ0Kas4LO5gRIIf","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>